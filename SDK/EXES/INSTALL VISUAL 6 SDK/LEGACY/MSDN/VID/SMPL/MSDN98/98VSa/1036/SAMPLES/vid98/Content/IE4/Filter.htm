<HTML>
<HEAD>

<STYLE>
	input.clsbtn {font-size:10;font-family:Verdana;color:yellow;background:black}
</STYLE>

<SCRIPT language=javascript>
var filterStrings = new Array();
var count = 0;
var wavable = 1;
var wavphase = 0;
var interval = 225;
var lightinterval = 100;
var lightcount = 0;
var maxStuff = 10;
var light;
var spread = 0;
var position = 0;
var chainable = 1;

function docoda(){
	glbimg.style.display = "none";
	dospin = 1;
	progress.innerText = "Les filtres peuvent être appliqués aux contrôles ActiveX dans une fenêtre à l'instar du contrôle Structured Graphics. Plusieurs lumières sont dirigées vers le graphique vectoriel tournant.";
	SG1.style.filter = "light(enabled=1)";
	light = SG1.filters[0];
	light.addambient(0,255,0,40);
	light.addpoint(50,50,40,255,0,0,100); 
	light.addpoint(120,90,30,0,0,255,100); 
	spinit();
}

function uncoda(){
	glbimg.style.display = "";
	glbimg.style.visibility = "visible";
	dospin = 0;
	SG1.style.filter = "";
	progress.innerText = "";
}

function spinit(){	
	if(dospin){
		SG1.rotate(0,0,3);
		window.setTimeout("spinit()", 0300, "JavaScript");
	}
}

function animatwav()
{
	if(wavable){
		wavphase = (wavphase + 10) % 100;
		if(theImg.style.filter == "wave(freq=4, strength=8, phase=0, lightstrength=25, add=1, enabled=1)"){
			theImg.filters[0].phase = wavphase;
		}
		window.setTimeout("animatwav()", 0400, "JavaScript");
	}
}

function chainwav()
{
	if(chainable){
		wavphase = (wavphase + 1) % 10;
		if(theImg.style.filter == "chroma(color=#ff0000,enabled=1) shadow(color=#5555ee,enabled=1) glow(enabled=1)"){
			theImg.filters[2].strength = wavphase;
		}
		window.setTimeout("chainwav()", 0400, "JavaScript");
	}
}

function DoLights()
{
	theImg.style.filter = "light";
	light = theImg.filters[0];
	progress.innerText = "Lumières (lumière) : Vous pouvez appliquer un éclairage ambient, conique et pointu sur des objets. Remarquez que l'ajout de lumières doit s'effectuer via un script (voir la source pour un exemple)";
	LightChange();
}

function LightChange()
{
	if ( lightcount++ < maxStuff )
	{
		spread += 10;
		position += 20;
		light.Clear(); //clear existing lights from collection

		//	-----------------------------------------------------------------------		//
		//	this routine is used to add the lights into the light filter collection		//	
		// 	the position and color of the lights in this sample are based off global	//
		//	values.  note the use of setTimeout to drive the animation.  if more 		//
		//	precise control is needed over the timing a sequencer should be used		//
		//	params for lights are:								//
		//											//
		//	addAmbient(rr,gg,bb,intensity)							//
		//	addPoint(x,y,z,rr,gg,bb,intensity)						//
		//	addCone(x,y,z,x-target,y-target,rr,gg,bb,intensity)				//
		//	------------------------------------------------------------------------	//

		light.addCone ( position,position,45,200,200,255,spread,spread,50,spread);
		light.addPoint ( position,position,200,spread,spread,spread,100);
		light.addAmbient ( 255,spread,spread,spread);
		setTimeout ( "LightChange()", lightinterval );
	}
	else
	{
		lightcount = 0;
		spread = 0;
		position = 0;
		document.finished = true;
	}
}


</SCRIPT>
</HEAD>

<BODY bgColor=#ffffff leftMargin=40 link=#500000 vLink=#505050 STYLE="color:olive">

<CENTER>
<DIV ID=theImg STYLE="WIDTH:90%" STYLE="font-size:18pt;font-family:verdana;font-style:bold">
	Les filtres peuvent être appliqués à n'importe quel élément HTML, notamment du texte, des contrôles sans fenêtre, des contrôles intrinsèques et des images. <P>
	<IMG ID=glbimg hspace=10 vspace=10 width=150 height=150 src="../images/globe.gif">

	<OBJECT ID=SG1
		STYLE="HEIGHT:150; WIDTH:150"
		CLASSID="CLSID:369303C2-D7AC-11D0-89D5-00A0C90833E6">
		<PARAM NAME="Line0001" VALUE="SetFillStyle(1)">
		<PARAM NAME="Line0002" VALUE="SetFillColor(255,255,255)">
		<PARAM NAME="Line0003" VALUE="Pie(-75,-75,150,150,0,10,0)">
		<PARAM NAME="Line0004" VALUE="SetFillColor(0,90,200)">
		<PARAM NAME="Line0005" VALUE="Pie(-75,-75,150,150,0,10,18)">
		<PARAM NAME="Line0006" VALUE="SetFillColor(255,255,255)">
		<PARAM NAME="Line0007" VALUE="Pie(-75,-75,150,150,0,10,36)">
		<PARAM NAME="Line0008" VALUE="SetFillColor(0,90,200)">
		<PARAM NAME="Line0009" VALUE="Pie(-75,-75,150,150,0,10,54)">
		<PARAM NAME="Line0010" VALUE="SetFillColor(255,255,255)">
		<PARAM NAME="Line0011" VALUE="Pie(-75,-75,150,150,0,10,72)">
		<PARAM NAME="Line0012" VALUE="SetFillColor(0,90,200)">
		<PARAM NAME="Line0013" VALUE="Pie(-75,-75,150,150,0,10,90)">
		<PARAM NAME="Line0014" VALUE="SetFillColor(255,255,255)">
		<PARAM NAME="Line0015" VALUE="Pie(-75,-75,150,150,0,10,108)">
		<PARAM NAME="Line0016" VALUE="SetFillColor(0,90,200)">
		<PARAM NAME="Line0017" VALUE="Pie(-75,-75,150,150,0,10,126)">
		<PARAM NAME="Line0018" VALUE="SetFillColor(255,255,255)">
		<PARAM NAME="Line0019" VALUE="Pie(-75,-75,150,150,0,10,144)">
		<PARAM NAME="Line0020" VALUE="SetFillColor(0,90,200)">
		<PARAM NAME="Line0021" VALUE="Pie(-75,-75,150,150,0,10,162)">
		<PARAM NAME="Line0022" VALUE="SetFillColor(255,255,255)">
		<PARAM NAME="Line0023" VALUE="Pie(-75,-75,150,150,0,10,180)">
		<PARAM NAME="Line0024" VALUE="SetFillColor(0,90,200)">
		<PARAM NAME="Line0025" VALUE="Pie(-75,-75,150,150,0,10,198)">
		<PARAM NAME="Line0026" VALUE="SetFillColor(255,255,255)">
		<PARAM NAME="Line0027" VALUE="Pie(-75,-75,150,150,0,10,216)">
		<PARAM NAME="Line0028" VALUE="SetFillColor(0,90,200)">
		<PARAM NAME="Line0029" VALUE="Pie(-75,-75,150,150,0,10,234)">
		<PARAM NAME="Line0030" VALUE="SetFillColor(255,255,255)">
		<PARAM NAME="Line0031" VALUE="Pie(-75,-75,150,150,0,10,252)">
		<PARAM NAME="Line0032" VALUE="SetFillColor(0,90,200)">
		<PARAM NAME="Line0033" VALUE="Pie(-75,-75,150,150,0,10,270)">
		<PARAM NAME="Line0034" VALUE="SetFillColor(255,255,255)">
		<PARAM NAME="Line0035" VALUE="Pie(-75,-75,150,150,0,10,288)">
		<PARAM NAME="Line0036" VALUE="SetFillColor(0,90,200)">
		<PARAM NAME="Line0037" VALUE="Pie(-75,-75,150,150,0,10,306)">
		<PARAM NAME="Line0038" VALUE="SetFillColor(255,255,255)">
		<PARAM NAME="Line0039" VALUE="Pie(-75,-75,150,150,0,10,324)">
		<PARAM NAME="Line0040" VALUE="SetFillColor(0,90,200)">
		<PARAM NAME="Line0041" VALUE="Pie(-75,-75,150,150,0,10,342)">
		<PARAM NAME="Line0042" VALUE="SetFillColor(255,255,255)">
		<PARAM NAME="Line0043" VALUE="Pie(-75,-75,150,150,0,10,360)">
	</OBJECT>
</DIV>
</CENTER>

<P>

<CENTER>
<input CLASS=clsbtn VALUE="RetournementH" TYPE=button NAME=filt onclick="theImg.style.filter = 'fliph(enabled=1)'; progress.innerText = 'Retournement horizontal (retournementh) : Retourne les pixels visibles dans l\'axe horizontal.';">
<input CLASS=clsbtn VALUE="RetournementV" TYPE=button NAME=filt onclick="theImg.style.filter = 'flipv(enabled=1)'; progress.innerText = 'Retournement vertical (flipv) : Retourne les pixels visibles dans l\'axe vertical.';">
<input CLASS=clsbtn VALUE="Gris" TYPE=button NAME=filt onclick="theImg.style.filter = 'gray(enabled=1)'; progress.innerText = 'Echelle de gris (gray) : Convertit les 256 nuances de gris des pixels visibles.';">
<input CLASS=clsbtn VALUE="Inverser" TYPE=button NAME=filt onclick="theImg.style.filter = 'invert(enabled=1)'; progress.innerText = 'Inverser (inverser) : Affecte aux pixels les valeurs opposées dans le spectre des couleurs.';">
<input CLASS=clsbtn VALUE="RayonX" TYPE=button NAME=filt onclick="theImg.style.filter = 'xray(enabled=1)'; progress.innerText = 'RayonX (xray) : Applique l\'échelle des gris et réduit la profondeur des couleurs.';">

<input CLASS=clsbtn VALUE="Alpha" TYPE=button NAME=alpha onclick="theImg.style.filter = 'alpha(opacity=50,enabled=1)'; progress.innerText = 'Canal Alpha (alpha) : Modifie l\'opacité de l\'objet filtré, permettant ainsi son mélange avec l\'arrière-plan.';">
<input CLASS=clsbtn VALUE="Brouiller" TYPE=button NAME=blur onclick="theImg.style.filter = 'blur(direction=45,strength=15, add=0, enabled=1)'; progress.innerText = 'Brouiller le mouvement (blur) : Brouille votre objet selon la direction et la force indiquées.';">
<input CLASS=clsbtn VALUE="Couleur" TYPE=button NAME=chrom onclick="theImg.style.filter = 'chroma(color=#FF0000 ,enabled=1)'; progress.innerText = 'Incrustation couleur (chroma) : Rend transparente une couleur spécifiée.';">
<input CLASS=clsbtn VALUE="Ombre portée" TYPE=button NAME=drop onclick="theImg.style.filter = 'dropshadow(offx=5, offy=9, color=#008fff,enabled=1)'; progress.innerText = 'Ombre portée (dropshadow): Crée une ombre de votre image avec le décalage et la couleur spécifiés.';">
<input CLASS=clsbtn VALUE="Lueur" TYPE=button NAME=glow onclick="theImg.style.filter = 'glow(strength=5, color=#ffff00,enabled=1)'; progress.innerText = 'Lueur (glow): Crée une lueur autour des pixels opaques de votre objet.';">
<input CLASS=clsbtn VALUE="Masque" TYPE=button NAME=mask onclick="theImg.style.filter = 'mask(color=#FF0000 ,enabled=1)'; progress.innerText = 'Masque (mask) : Transforme les pixels transparents en couleur spécifiée et rend transparents les pixels opaques.';">
<input CLASS=clsbtn VALUE="Ombre" TYPE=button NAME=shad onclick="theImg.style.filter = 'shadow(color=#FF0088,direction=315,enabled=1)'; progress.innerText = 'Ombre (shadow): Crée une ombre atténuée dans la direction et la couleur spécifiées.';">
<input CLASS=clsbtn VALUE="Onde" TYPE=button NAME=wave onclick="theImg.style.filter = 'wave(freq=2, strength=6, phase=0, lightstrength=0, add=0, enabled=1)'; progress.innerText = 'Onde (wave) : Applique une déformation d\'onde sinuso&#239;dale à votre objet.';"><P>
<input CLASS=clsbtn VALUE="Onde sinusoïdale animée" TYPE=button NAME=animwave onclick="theImg.style.filter = 'wave(freq=4, strength=8, phase=0, lightstrength=25, add=1, enabled=1)'; progress.innerText = 'Les paramètres des filtres peuvent être modifiés dynamiquement pour l\'animation.'; wavable = 1; animatwav();">
<input CLASS=clsbtn VALUE="Filtres en chaîne" TYPE=button NAME=chainwave onclick="theImg.style.filter = 'chroma(color=#ff0000,enabled=1) shadow(color=#ff0000,enabled=1) chroma(color=ffff00,enabled=1)'; progress.innerText = 'Les filtres peuvent être constitués en cha&#238;ne pour renforcer les effets.';">
<input CLASS=clsbtn VALUE="Sous les projecteurs" TYPE=button NAME=light onclick="DoLights()">
<input CLASS=clsbtn VALUE="Effacer le filtre" TYPE=button NAME=clear onclick="theImg.style.filter = ''; progress.innerText = 'choisissez un filtre';">
<input CLASS=clsbtn VALUE="Activer l'ensemble" TYPE=button NAME=coda onclick="theImg.style.filter = ''; window.setTimeout('docoda()', 0100, 'javascript');">
</CENTER>

<BR><BR>
<DIV ID=progress STYLE="font-color:gold;font-size:16pt;font-family:verdana;width:100%;background-color:black;filter:alpha(opacity=40,enabled=1);text-align:center">Cliquez sur l'un des boutons des filtres pour appliquer un filtre aux objets.</DIV>
<SCRIPT LANGUAGE="vbscript">
dim notclicked
notclicked = 1

sub window_onload()
	filk = window.setTimeout("maybe", 4000, "vbscript")
end sub
sub document_onclick()
	notclicked = 0
end sub
sub maybe()
	if notclicked then
		progress.innerText = "Venez participer à la fête binaire. Cliquez sur un bouton pour appliquer l'un de nos supers filtres."
	end if
end sub
sub animwave_onblur()
	wavable = 0
end sub
sub chainwave_onblur()
	chainable =0
end sub
sub coda_onblur()
	uncoda
end sub
</SCRIPT>
</BODY>
</HTML>
