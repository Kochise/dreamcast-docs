<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IFilterGraph Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0139.htm','/dssd0000.htm','/dssd0088.htm','/index.htm','/dssd0141.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_0001060134000000">IFilterGraph Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IFilterGraph</B> interface is an abstraction representing a graph of filters.
All filters in the graph share the same clock. They might or might not also be connected
and stream data between them. This interface allows filters to be joined into a graph and
operated as a unit. Unlike the <A HREF="dssd0146.htm" TARGET="TEXT">IGraphBuilder</A> interface, this interface does not use
heuristics to connect and build the filter graph.

<A NAME="If_0001060134010000"></A><P><B>When to Implement</B>
<P>This interface is implemented on the filter graph manager and is not intended
for implementation by developers.

<A NAME="If_0001060134020000"></A><P><B>When to Use</B>
<P>Applications should not use this interface directly but instead should use
the <A HREF="dssd0146.htm" TARGET="TEXT">IGraphBuilder</A> interface, which inherits this interface.

<A NAME="If_0001060134030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IFilterGraph methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030100" TARGET="TEXT">AddFilter</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds a filter to the graph and gives it a name.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030700" TARGET="TEXT">RemoveFilter</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Removes a filter from the graph.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030400" TARGET="TEXT">EnumFilters</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Provides an enumerator for all filters in the graph.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030500" TARGET="TEXT">FindFilterByName</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Finds a filter that was added with a specified name.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030200" TARGET="TEXT">ConnectDirect</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Connects the two <A HREF="dssd0165.htm" TARGET="TEXT">IPin</A> objects directly (without intervening filters).
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030600" TARGET="TEXT">Reconnect</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Breaks the existing pin connection and reconnects it to the same pin.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030300" TARGET="TEXT">Disconnect</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Disconnects this pin, if connected.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030800" TARGET="TEXT">SetDefaultSyncSource</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the default synchronization source (a clock).
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="If_0001060134030100">IFilterGraph::AddFilter</A></H3>
<A HREF="dssd0140.htm" TARGET="TEXT">IFilterGraph Interface</A>
<P>Adds a filter to the graph and names it by using the <I>pName</I> parameter.

<P><B>HRESULT</B> <B>AddFilter</B><B>(</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <B>*</B> <I>pFilter</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>pName</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pFilter</I>
</DT><DD>[in] Filter to add to the graph.
</DD><DT><I>pName</I>
</DT><DD>[in] Name of the filter.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>The name of the filter can be NULL, in which case the filter graph manager will generate a name.
 If the name is not NULL and is not unique, this method will modify the name in an attempt
to generate a new unique name. If this is successful, this method returns
 <A HREF="dssd0293.htm#errcodes_0001060a01000056" TARGET="TEXT">VFW_S_DUPLICATE_NAME</A>. If it cannot generate a unique name, it returns <A HREF="dssd0293.htm#errcodes_0001060a01000055" TARGET="TEXT">VFW_E_DUPLICATE_NAME</A>.

<P><B>AddFilter</B> calls the filter's <A HREF="dssd0116.htm#If_000106011c030300" TARGET="TEXT">IBaseFilter::JoinFilterGraph</A> method to inform the filter
that it has been added. <B>AddFilter</B> must be called before attempting to use the
 <A HREF="dssd0146.htm#If_000106013a030200" TARGET="TEXT">IGraphBuilder::Connect</A>, <A HREF="dssd0140.htm#If_0001060134030200" TARGET="TEXT">IFilterGraph::ConnectDirect</A>, or
 <A HREF="dssd0146.htm#If_000106013a030300" TARGET="TEXT">IGraphBuilder::Render</A> method to connect or render pins belonging to the added filter.
<H3><HR COLOR=#0000FF><A NAME="If_0001060134030200">IFilterGraph::ConnectDirect</A></H3>
<A HREF="dssd0140.htm" TARGET="TEXT">IFilterGraph Interface</A>
<P>Connects the two pins directly (without intervening filters).

<P><B>HRESULT</B> <B>ConnectDirect</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppinOut</I><B>,</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppinIn</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>AM_MEDIA_TYPE</B> <B>*</B> <I>pmt</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppinOut</I>
</DT><DD>[in] Output pin.
</DD><DT><I>ppinIn</I>
</DT><DD>[in] Input pin.
</DD><DT><I>pmt</I>
</DT><DD>[in] Media type to use for the connection (optional; that is, can be NULL).
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H3><HR COLOR=#0000FF><A NAME="If_0001060134030300">IFilterGraph::Disconnect</A></H3>
<A HREF="dssd0140.htm" TARGET="TEXT">IFilterGraph Interface</A>
<P>Disconnects this pin.

<P><B>HRESULT</B> <B>Disconnect</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppin</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppin</I>
</DT><DD>[in] Pin to disconnect.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method does not completely break the connection. To completely break
the connection, both ends must be disconnected.

<P>This method results in a successful no operation (no-op) if the pin is not connected.
<H3><HR COLOR=#0000FF><A NAME="If_0001060134030400">IFilterGraph::EnumFilters</A></H3>
<A HREF="dssd0140.htm" TARGET="TEXT">IFilterGraph Interface</A>
<P>Provides an enumerator for all filters in the graph.

<P><B>HRESULT</B> <B>EnumFilters</B><B>(</B><BR>&nbsp;&nbsp;<B>IEnumFilters</B> <B>**</B> <I>ppEnum</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppEnum</I>
</DT><DD>[out] Enumerator.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>The interface returned by this method has had its reference count
incremented. Be sure to use <A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">IUnknown::Release</A> on the interface
to decrement the reference count when you have finished using the interface.

<H3><HR COLOR=#0000FF><A NAME="If_0001060134030500">IFilterGraph::FindFilterByName</A></H3>
<A HREF="dssd0140.htm" TARGET="TEXT">IFilterGraph Interface</A>
<P>Finds a filter that was added to the filter graph with a specific name.

<P><B>HRESULT</B> <B>FindFilterByName</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>pName</I><B>,</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <B>**</B> <I>ppFilter</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pName</I>
</DT><DD>[in, string] Name to search for.
</DD><DT><I>ppFilter</I>
</DT><DD>[out] Pointer to an <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> interface on the found filter.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This function fails and sets pointers to the <I>ppFilter</I> parameter to NULL
if the name is not in this graph.
<H3><HR COLOR=#0000FF><A NAME="If_0001060134030600">IFilterGraph::Reconnect</A></H3>
<A HREF="dssd0140.htm" TARGET="TEXT">IFilterGraph Interface</A>
<P>Disconnects this and the pin to which it connects and
then reconnects it to the same pin. This allows the details of the connection, such as media type
and allocator, to be renegotiated.

<P><B>HRESULT</B> <B>Reconnect</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppin</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppin</I>
</DT><DD>[in] Pin to disconnect and reconnect.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method performs its operation on a separate thread that will
not hold any relevant locks.
It can be called by a pin or filter to allow renegotiation of the connection.
When a transform filter has its input connected, it must agree upon some media type.
When the output is connected, it might discover that, to please both its upstream
and downstream connections, it would have been better to have chosen a different
media type for the upstream connection. The solution is to reconnect the input pin.
The caller of this method should ensure (for example, by calling
<A HREF="dssd0165.htm#If_000106014d030a00" TARGET="TEXT">IPin::QueryAccept</A>) that the resulting
renegotiation will succeed, because the reconnection process is
performed asynchronously and there is no mechanism for reporting or correcting errors.
<H3><HR COLOR=#0000FF><A NAME="If_0001060134030700">IFilterGraph::RemoveFilter</A></H3>
<A HREF="dssd0140.htm" TARGET="TEXT">IFilterGraph Interface</A>
<P>Removes a filter from the graph.

<P><B>HRESULT</B> <B>RemoveFilter</B><B>(</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <B>*</B> <I>pFilter</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pFilter</I>
</DT><DD>[in] Pointer to the filter to be removed from the graph.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>The filter graph implementation informs the filter that it is being
removed by calling the <A HREF="dssd0116.htm#If_000106011c030300" TARGET="TEXT">IBaseFilter::JoinFilterGraph</A> method with a NULL argument.
<H3><HR COLOR=#0000FF><A NAME="If_0001060134030800">IFilterGraph::SetDefaultSyncSource</A></H3>
<A HREF="dssd0140.htm" TARGET="TEXT">IFilterGraph Interface</A>
<P>Sets the default source of synchronization.

<P><B>HRESULT</B> <B>SetDefaultSyncSource</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method is used when no clock has been given to the filter graph, and
the filter graph manager consequently must find a clock to use as the synchronization
source.

The filter graph manager first tries all filters, starting with
renderers, to see if any filter exports a clock (by providing an
<A HREF="dssd0170.htm" TARGET="TEXT">IReferenceClock</A> interface).
The filter graph manager will choose the first filter that it finds, providing
that filter is connected to an upstream source. If no connected filters are
found, the first filter if <B>IReferenceClock</B> is used.
Typically, this will be the audio rendering filter.
If no filter exports a clock, the filter graph manager uses a system clock.

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
