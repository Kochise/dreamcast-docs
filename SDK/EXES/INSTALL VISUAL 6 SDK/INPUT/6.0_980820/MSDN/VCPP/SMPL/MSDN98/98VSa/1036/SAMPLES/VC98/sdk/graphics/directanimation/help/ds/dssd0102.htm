<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IAMLine21Decoder Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0101.htm','/dssd0000.htm','/dssd0088.htm','/index.htm','/dssd0103.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_000106010e000000">IAMLine21Decoder Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IAMLine21Decoder</B> interface provides access to closed-captioned information and settings. Closed-captioned information is transmitted in the vertical blanking interval (VBI) of television signals, specifically on line 21 (Line21) of field 1 in the VBI. Video cassette recorders record this information on video tape, and you can use Microsoft&#174; DirectShow&#153; filters to capture the Line21



 data and save it on disk in a media file format such as audio-video interleaved (AVI). The closed-captioned information appears as a separate stream within the media file.

<P>Closed-captioned text is currently used mainly in digital versatile disc (DVD) movies. DVD movies contain Line21 data as part of the user data section of each Group of Pictures (GOP) in the video stream. In the future, new capture cards with Windows Driver Model (WDM) drivers will provide Line21 data.



<A NAME="If_000106010e010000"></A><P><B>When to Implement</B>
<P><P><B>Note:</B>  DirectShow will provide this implementation post-beta 2.<P>Do not implement this interface. DirectShow provides the <A HREF="dssd0327.htm#filteref_0001070121000000" TARGET="TEXT">Line 21 Decoder</A>, which implements it for you.



<A NAME="If_000106010e020000"></A><P><B>When to Use</B>
<P>Applications use this interface when they want to provide closed-captioned text, primarily to turn closed-captioned capabilities on and off. Use this interface in your application or in the filter immediately downstream of the Line21 Decoder filter (typically a mixer filter) to change closed-captioned options, such as the output video's size and whether to make the caption background opaque or transparent. Mixer filters can also change the physical color used for the background color key.

<P>Applications can call the <A HREF="dssd0102.htm#If_000106010e030400" TARGET="TEXT">GetDrawBackgroundMode</A> and <A HREF="dssd0102.htm#If_000106010e030a00" TARGET="TEXT">SetDrawBackgroundMode</A> methods so the user can select transparent or opaque captioning.

<A NAME="If_000106010e030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IAMLine21Decoder methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030300" TARGET="TEXT">GetDecoderLevel</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the closed-captioned decoder level.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030200" TARGET="TEXT">GetCurrentService</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the current closed captioning service selected by the user.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030900" TARGET="TEXT">SetCurrentService</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the current closed captioning service.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030700" TARGET="TEXT">GetServiceState</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the closed captioning service state (on or off). 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030d00" TARGET="TEXT">SetServiceState</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the closed captioning service state. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030500" TARGET="TEXT">GetOutputFormat</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves information about output video characteristics such as size and bit depth.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030b00" TARGET="TEXT">SetOutputFormat</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets information that describes output video characteristics such as size and bit depth.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030100" TARGET="TEXT">GetBackgroundColor</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the physical color to use as background for overlays.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030800" TARGET="TEXT">SetBackgroundColor</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the physical color to use as background for overlays.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030600" TARGET="TEXT">GetRedrawAlways</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves whether the renderer should redraw the whole output bitmap for each sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030c00" TARGET="TEXT">SetRedrawAlways</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets whether the renderer should redraw the whole output bitmap for each sample.

</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030400" TARGET="TEXT">GetDrawBackgroundMode</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves whether the caption text background should be opaque or transparent.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0102.htm#If_000106010e030a00" TARGET="TEXT">SetDrawBackgroundMode</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets whether to make the caption text background opaque or transparent.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030100">IAMLine21Decoder::GetBackgroundColor</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Retrieves the physical color to use as background for overlays.
<P><BR><B>HRESULT</B> <B>GetBackgroundColor</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwPhysColor</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pdwPhysColor</I>
 </DT><DD>Pointer to the retrieved <A HREF="dssd0389.htm#external_00010a010900002b" TARGET="TEXT">DWORD</A> value. 
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.

<H5>Remarks</H5>
<P>Magenta is the default background color.
<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030800" TARGET="TEXT">IAMLine21Decoder::SetBackgroundColor</A>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030200">IAMLine21Decoder::GetCurrentService</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Retrieves the current closed captioning service selected by the user.
<P><BR><B>HRESULT</B> <B>GetCurrentService</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_CCSERVICE</B> <I>*lpService</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpService</I>
 </DT><DD>Pointer to the current service. This value is a member of the <A HREF="dssd0288.htm#dtypes_0001060601000500" TARGET="TEXT">AM_LINE21_CCSERVICE</A> enumerated data type. The default service is <A HREF="dssd0288.htm#dtypes_0001060601000502" TARGET="TEXT">AM_L21_CCSERVICE_Caption1</A>.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.

<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030900" TARGET="TEXT">IAMLine21Decoder::SetCurrentService</A>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030300">IAMLine21Decoder::GetDecoderLevel</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Retrieves the closed-captioned decoder level.
<P><BR><B>HRESULT</B> <B>GetDecoderLevel</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_CCLEVEL</B> <I>*lpLevel</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpLevel</I>
 </DT><DD>Pointer to the retrieved decoder level. <A HREF="dssd0288.htm#dtypes_0001060601000401" TARGET="TEXT">AM_L21_CCLEVEL_TC2</A> (TC2) is the only supported operating channel level and is an enhanced and backward-compatible version of the original TC1 level.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.

<H5>Remarks</H5>
<P>This method is for informational purposes only. 

<P>TC1 and TC2 are television set decoder levels that represent whether the television can handle some closed-captioned byte pairs and produce the desired captioning results. The Line21 Decoder is capable of TC2 level decoding, which includes all TC1 decoding. Only the first 100,000 television sets manufactured that included closed-captioned capability were TC1 compliant; the later TV sets are TC2 compliant.
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030400">IAMLine21Decoder::GetDrawBackgroundMode</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Retrieves whether the caption text background should be opaque or transparent.
<P><BR><B>HRESULT</B> <B>GetDrawBackgroundMode</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_DRAWBGMODE</B> <I>*lpMode</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpMode</I>
 </DT><DD>Retrieved mode. Supported mode values are <A HREF="dssd0288.htm#dtypes_0001060601000701" TARGET="TEXT">AM_L21_DRAWBGMODE_Opaque</A> and <A HREF="dssd0288.htm#dtypes_0001060601000702" TARGET="TEXT">AM_L21_DRAWBGMODE_Transparent</A>.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.

<H5>Remarks</H5>
<P>By default, the caption background is opaque.
<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030a00" TARGET="TEXT">IAMLine21Decoder::SetDrawBackgroundMode</A>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030500">IAMLine21Decoder::GetOutputFormat</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Retrieves information about output video characteristics such as size and bit depth.
<P><BR><B>HRESULT</B> <B>GetOutputFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>LPBITMAPINFOHEADER</B> <I>lpbmih</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpbmih</I>
 </DT><DD>Pointer to the retrieved <A HREF="dssd0075.htm#avispec_0001050502020800" TARGET="TEXT">BITMAPINFOHEADER</A> structure.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<P>If successful, the default implementation returns S_FALSE if downstream filters haven't defined an output format, or S_OK if an output format has been defined.



<H5>Remarks</H5>
<P>The default video output size is 320 &#215; 240 pixels.


<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030b00" TARGET="TEXT">IAMLine21Decoder::SetOutputFormat</A>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030600">IAMLine21Decoder::GetRedrawAlways</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Retrieves whether the renderer should redraw the whole output bitmap for each sample.
<P><BR><B>HRESULT</B> <B>GetRedrawAlways</B><B>(</B><BR>&nbsp;&nbsp;<B>LPBOOL</B> <I>lpbOption</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpbOption</I>
 </DT><DD>Pointer to a value indicating whether the whole bitmap should be redrawn; FALSE by default, indicating don't always redraw. TRUE means always redraw.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.

<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030c00" TARGET="TEXT">IAMLine21Decoder::SetRedrawAlways</A>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030700">IAMLine21Decoder::GetServiceState</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Retrieves the closed captioning service state (on or off). 
<P><BR><B>HRESULT</B> <B>GetServiceState</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_CCSTATE</B> <I>*lpState</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpState</I>
 </DT><DD>Pointer to the retrieved state. Supported state values are <A HREF="dssd0288.htm#dtypes_0001060601000602" TARGET="TEXT">AM_L21_CCSTATE_On</A> and <A HREF="dssd0288.htm#dtypes_0001060601000601" TARGET="TEXT">AM_L21_CCSTATE_Off</A>. Closed-captioned text is off by default.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.

<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030d00" TARGET="TEXT">IAMLine21Decoder::SetServiceState</A>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030800">IAMLine21Decoder::SetBackgroundColor</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Sets the physical color to use as background for overlays.
 <P><BR><B>HRESULT</B> <B>SetBackgroundColor</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwPhysColor</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>dwPhysColor</I>
 </DT><DD><A HREF="dssd0389.htm#external_00010a010900002b" TARGET="TEXT">DWORD</A> value that specifies the physical background color. 
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.

<H5>Remarks</H5>
<P>Magenta is the default background color.
<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030100" TARGET="TEXT">IAMLine21Decoder::GetBackgroundColor</A>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030900">IAMLine21Decoder::SetCurrentService</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Sets the current closed captioning service.
<P><BR><B>HRESULT</B> <B>SetCurrentService</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_CCSERVICE</B> <I>Service</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>Service</I>
 </DT><DD>Specified service. This value is a member of the <A HREF="dssd0288.htm#dtypes_0001060601000500" TARGET="TEXT">AM_LINE21_CCSERVICE</A> enumerated data type. The default service is <A HREF="dssd0288.htm#dtypes_0001060601000502" TARGET="TEXT">AM_L21_CCSERVICE_Caption1</A>.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.

<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030200" TARGET="TEXT">IAMLine21Decoder::GetCurrentService</A>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030a00">IAMLine21Decoder::SetDrawBackgroundMode</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Sets whether to make the caption text background opaque or transparent.
<P><BR><B>HRESULT</B> <B>SetDrawBackgroundMode</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_DRAWBGMODE</B> <I>Mode</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>Mode</I>
 </DT><DD>Mode to set. Supported mode values are <A HREF="dssd0288.htm#dtypes_0001060601000701" TARGET="TEXT">AM_L21_DRAWBGMODE_Opaque</A> and <A HREF="dssd0288.htm#dtypes_0001060601000702" TARGET="TEXT">AM_L21_DRAWBGMODE_Transparent</A>.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.

<H5>Remarks</H5>
<P>By default, the caption background is opaque.
<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030400" TARGET="TEXT">IAMLine21Decoder::GetDrawBackgroundMode</A>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030b00">IAMLine21Decoder::SetOutputFormat</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Sets information that describes output video characteristics such as size and bit depth.
<P><BR><B>HRESULT</B> <B>SetOutputFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>LPBITMAPINFO</B> <I>lpbmi</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpbmi</I>
 </DT><DD>Pointer to the specified <A HREF="dssd0075.htm#avispec_0001050502020801" TARGET="TEXT">BITMAPINFO</A> structure containing the desired output format.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>The default video output size is 320 &#215; 240 pixels.
<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030500" TARGET="TEXT">IAMLine21Decoder::GetOutputFormat</A>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030c00">IAMLine21Decoder::SetRedrawAlways</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Sets whether the renderer should redraw the whole output bitmap for each sample.
<P><BR><B>HRESULT</B> <B>SetRedrawAlways</B><B>(</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bOption</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>bOption</I>
 </DT><DD>Value indicating whether the whole bitmap should be redrawn. TRUE indicates redraw always, FALSE means do not redraw always.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.

<H5>Remarks</H5>
<P>Call this method from your filter if it dirties the buffer that it provides to the Line21 Decoder filter. Typically, a mixer filter resides in the filter graph directly downstream from the Line21 Decoder filter. The mixer filter should call this method and set <I>bOption</I> to TRUE to ensure the entire bitmap is redrawn properly.

<P>A downstream mixer (or any filter that needs to do so) should only call this method with <I>bOption</I> set to TRUE if it provides the same buffer to the Line21 decoder as it uses to mix secondary video streams(s).

<P> Redrawing (setting <I>bOption</I> to TRUE) degrades performance and increases CPU load, because it negates any potential optimizations.
<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030600" TARGET="TEXT">IAMLine21Decoder::GetRedrawAlways</A>
<H3><HR COLOR=#0000FF><A NAME="If_000106010e030d00">IAMLine21Decoder::SetServiceState</A></H3>
<A HREF="dssd0102.htm" TARGET="TEXT">IAMLine21Decoder Interface</A>
<P>Sets the closed captioning service state. 
<P><BR><B>HRESULT</B> <B>SetServiceState</B><B>(</B><BR>&nbsp;&nbsp;<B>AM_LINE21_CCSTATE</B> <I>State</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>State</I>
 </DT><DD>Specified state. Supported state values are <A HREF="dssd0288.htm#dtypes_0001060601000602" TARGET="TEXT">AM_L21_CCSTATE_On</A> and <A HREF="dssd0288.htm#dtypes_0001060601000601" TARGET="TEXT">AM_L21_CCSTATE_Off</A>. Closed-captioned text is off by default.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns E_INVALIDARG if a parameter is invalid or NOERROR to indicate success.

<H5>See Also</H5>
<P><A HREF="dssd0102.htm#If_000106010e030700" TARGET="TEXT">IAMLine21Decoder::GetServiceState</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
