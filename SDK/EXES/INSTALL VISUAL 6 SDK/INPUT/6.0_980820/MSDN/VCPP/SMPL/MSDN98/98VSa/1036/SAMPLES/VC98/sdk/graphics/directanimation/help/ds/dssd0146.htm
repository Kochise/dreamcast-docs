<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IGraphBuilder Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0145.htm','/dssd0000.htm','/dssd0088.htm','/index.htm','/dssd0147.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_000106013a000000">IGraphBuilder Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IGraphBuilder</B> interface allows applications to call upon the filter
graph manager to attempt to build a complete filter graph, or parts of a filter
graph given only partial information, such as the name of a file or the interfaces
of two separate pins. The filter mapper looks up filters in the
registry to configure the filter graph in a meaningful way.

<P><B>IGraphBuilder</B> inherits from the <A HREF="dssd0140.htm" TARGET="TEXT">IFilterGraph</A> interface and
exposes all its methods. For this reason, <B>IFilterGraph</B> should normally
not be used directly.

<A NAME="If_000106013a010000"></A><P><B>When to Implement</B>
<P>This interface is implemented on the filter graph manager and is not intended
for implementation by developers.

<A NAME="If_000106013a020000"></A><P><B>When to Use</B>
<P>Applications use this interface to create a filter graph, add filters to
or remove filters from a filter graph, enumerate all the filters in a filter graph,
and force connections when adding a filter. Filters typically use the interface to
reconnect pins during the connection and negotiation process of building a filter graph.

<A NAME="If_000106013a030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IFilterGraph methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030100" TARGET="TEXT">AddFilter</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds a filter to the graph and gives it a name.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030700" TARGET="TEXT">RemoveFilter</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Removes a filter from the graph.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030400" TARGET="TEXT">EnumFilters</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Provides an enumerator for all filters in the graph.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030500" TARGET="TEXT">FindFilterByName</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Finds a filter that was added with a specified name.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030200" TARGET="TEXT">ConnectDirect</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Connects the two <A HREF="dssd0165.htm" TARGET="TEXT">IPin</A> objects directly (without intervening filters).
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030600" TARGET="TEXT">Reconnect</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Breaks the existing pin connection and reconnects it to the same pin.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030300" TARGET="TEXT">Disconnect</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Disconnects this pin, if connected.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0140.htm#If_0001060134030800" TARGET="TEXT">SetDefaultSyncSource</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the default synchronization source (a clock).
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IGraphBuilder methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0146.htm#If_000106013a030200" TARGET="TEXT">Connect</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Connects two <A HREF="dssd0165.htm" TARGET="TEXT">IPin</A> objects. If they will not connect directly, this method
connects them with intervening transforms.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0146.htm#If_000106013a030300" TARGET="TEXT">Render</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds a chain of filters to this output pin to render it.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0146.htm#If_000106013a030400" TARGET="TEXT">RenderFile</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Builds a filter graph that renders the specified file.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0146.htm#If_000106013a030100" TARGET="TEXT">AddSourceFilter</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds a source filter to the filter graph for a specific file. The <A HREF="dssd0146.htm#If_000106013a030400" TARGET="TEXT">IGraphBuilder::RenderFile</A> method calls this to find the source filter.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0146.htm#If_000106013a030500" TARGET="TEXT">SetLogFile</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the log file into which actions taken in attempting to perform an operation are logged.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="If_000106013a030100">IGraphBuilder::AddSourceFilter</A></H3>
<A HREF="dssd0146.htm" TARGET="TEXT">IGraphBuilder Interface</A>
<P>Adds a source filter to the filter graph for a specific file.

<P><B>HRESULT</B> <B>AddSourceFilter</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpwstrFileName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpwstrFilterName</I><B>,</B><BR>&nbsp;&nbsp;<B>IBaseFilter*</B> <B>*</B> <I>ppFilter</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpwstrFileName</I>
</DT><DD>[in] Pointer to the file.
</DD><DT><I>lpwstrFilterName</I>
</DT><DD>[in] Name to give the source filter when it is added.
</DD><DT><I>ppFilter</I>
</DT><DD>[out] Pointer to an <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> interface on the filter that was added.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method allows you to obtain and retain more control over building
the rest of the graph. For example, you can use the <A HREF="dssd0140.htm#If_0001060134030100" TARGET="TEXT">IFilterGraph::AddFilter</A> method
to add a renderer of your choice, and then use the <A HREF="dssd0146.htm#If_000106013a030200" TARGET="TEXT">IGraphBuilder::Connect</A> method
to connect the two filters. The <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> interface exposed by the source filter is returned
in the <I>ppFilter</I> parameter, and the reference is already added by the
<A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">IUnknown::AddRef</A> method. The <I>lpwstrFilterName</I> parameter is used to allow the
filter to be identified by this name in this filter graph. For more information, see <A HREF="dssd0140.htm#If_0001060134030500" TARGET="TEXT">FindFilterByName</A>.

<P>It is the application's responsibility to find the output pin of the
added source filter in order to build the rest of the filter graph,
which can be done by calling <A HREF="dssd0146.htm#If_000106013a030300" TARGET="TEXT">IGraphBuilder::Render</A> on the output pin,
to build the entire filter graph automatically, or by adding and connecting
filters individually. Note that, when adding filters individually, the asynchronous
file reader source filter and the URL moniker source filter do not parse the data,
so the output pins of these source filters can be connected only to a parser filter,
such as the MPEG splitter filter.

<P>Note that the <A HREF="dssd0146.htm#If_000106013a030400" TARGET="TEXT">IGraphBuilder::RenderFile</A> method adds the same source filter.
<H3><HR COLOR=#0000FF><A NAME="If_000106013a030200">IGraphBuilder::Connect</A></H3>
<A HREF="dssd0146.htm" TARGET="TEXT">IGraphBuilder Interface</A>
<P>Connects the two pins, using intermediates if necessary.

<P><B>HRESULT</B> <B>Connect</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppinOut</I><B>,</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppinIn</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppinOut</I>
</DT><DD>[in] Output pin.
</DD><DT><I>ppinIn</I>
</DT><DD>[in] Input pin.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method connects these two pins directly or indirectly, using transform filters if
necessary. The method either succeeds or leaves the filter graph unchanged.
The filter graph manager attempts a direct connection. If that fails, it attempts
to use any available transforms provided by filters that are already in the filter graph.
(It enumerates these in an arbitrary order.) If that fails, it attempts to find filters
from the registry to provide a transform. These will be tried in order of merit.
<H3><HR COLOR=#0000FF><A NAME="If_000106013a030300">IGraphBuilder::Render</A></H3>
<A HREF="dssd0146.htm" TARGET="TEXT">IGraphBuilder Interface</A>
<P>Builds a filter graph that renders the data from this output pin.

<P><B>HRESULT</B> <B>Render</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <B>*</B> <I>ppinOut</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppinOut</I>
</DT><DD>[in] Output pin.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value, which can include one of the following:
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0293.htm#errcodes_0001060a01000077" TARGET="TEXT">VFW_S_AUDIO_NOT_RENDERED</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0293.htm#errcodes_0001060a01000056" TARGET="TEXT">VFW_S_DUPLICATE_NAME</A> 
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0293.htm#errcodes_0001060a01000067" TARGET="TEXT">VFW_S_PARTIAL_RENDER</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0293.htm#errcodes_0001060a01000079" TARGET="TEXT">VFW_S_RPZA</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0293.htm#errcodes_0001060a01000076" TARGET="TEXT">VFW_S_VIDEO_NOT_RENDERED</A>
</FONT></TD></TABLE>

<H5>Remarks</H5>
<P>This method connects this output pin directly or indirectly to a filter or filters
that will render it, using transform filters as intermediary filters if necessary.
Filters are tried in the same order as for the <A HREF="dssd0146.htm#If_000106013a030200" TARGET="TEXT">IGraphBuilder::Connect</A> method.
<H3><HR COLOR=#0000FF><A NAME="If_000106013a030400">IGraphBuilder::RenderFile</A></H3>
<A HREF="dssd0146.htm" TARGET="TEXT">IGraphBuilder Interface</A>
<P>Builds a filter graph that renders the specified file.

<P><B>HRESULT</B> <B>RenderFile</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpwstrFile</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>lpwstrPlayList</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpwstrFile</I>
</DT><DD>[in] Name of the file containing the data to be rendered.
</DD><DT><I>lpwstrPlayList</I>
</DT><DD>[in] Playlist name. Reserved; must be NULL.
(This parameter is currently unimplemented.)
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value, which can include one of the following:
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0293.htm#errcodes_0001060a01000077" TARGET="TEXT">VFW_S_AUDIO_NOT_RENDERED</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0293.htm#errcodes_0001060a01000056" TARGET="TEXT">VFW_S_DUPLICATE_NAME</A> 
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0293.htm#errcodes_0001060a01000067" TARGET="TEXT">VFW_S_PARTIAL_RENDER</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0293.htm#errcodes_0001060a01000079" TARGET="TEXT">VFW_S_RPZA</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0293.htm#errcodes_0001060a01000076" TARGET="TEXT">VFW_S_VIDEO_NOT_RENDERED</A>
</FONT></TD></TABLE>

<H5>Remarks</H5>
<P>If the <I>lpwstrPlayList</I> parameter is NULL, this method would use the
default playlist, which typically renders the entire file.
<H3><HR COLOR=#0000FF><A NAME="If_000106013a030500">IGraphBuilder::SetLogFile</A></H3>
<A HREF="dssd0146.htm" TARGET="TEXT">IGraphBuilder Interface</A>
<P>Sets the file into which actions taken in attempting to perform an operation are logged.

<P><B>HRESULT</B> <B>SetLogFile</B><B>(</B><BR>&nbsp;&nbsp;<B>HANDLE</B> <I>hFile</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>hFile</I>
 </DT><DD>Handle to the log file.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.
<H5>Remarks</H5>
<P>The <I>hFile</I> parameter must be an open file handle. After calling this method with a valid
file handle, actions taken by <A HREF="dssd0146.htm" TARGET="TEXT">IGraphBuilder</A> methods when attempting to build a filter graph
are logged to this file. This is intended to help you determine the cause of any failure to automatically
 build a filter graph.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
