<HTML>
<HEAD>
<TITLE>Microsoft DirectAnimation Controls - Path KeyFrame and OnMarker sample</TITLE>

</HEAD>

<!--This sets up the array of KeyFrame points and the array of Time values-->
<SCRIPT language=JScript>
	var KeyFrameArray;
	KeyFrameArray = new Array(20,50, 30,30, 50,10, 80,40, 110,60, 130,50, 140,30, 130,10, 110,20, 80,40, 50,60, 20,50);
	var TimeArray;
	TimeArray = new Array(1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000);
</SCRIPT>

<!--This adds the 2nd & 3rd Timemarkers, loads the arrays of KeyFrame points and Time values and starts the path playback -->
<SCRIPT language=JScript>
	function KeyFrame()
	{
		PTH1.AddTimeMarker(3.0, "Second", 0)
		PTH1.AddTimeMarker(6.0, "Third", 0)
		PTH1.KeyFrame(12,KeyFrameArray,TimeArray);
		PTH1.Play();
	}
</SCRIPT>

<!--This checks the markername of the onmarker event, and writes out the strings below to the DIV, based on the marker -->
<SCRIPT language=VBScript> 
Sub PTH1_onmarker(markername)
	Select Case markername
		Case "First"
			Progress.innerText = "1st Keyframe & 1st Marker"
		Case "Second"
			Progress.innerText = "3rd Keyframe & 2nd Marker"
		Case "Third"
			Progress.innerText = "6th Keyframe & 3rd Marker"
		Case "Fourth"
			Progress.innerText = "9th Keyframe & 4th Marker"
	End Select
End Sub
</SCRIPT>


<BODY TEXT=BLUE onload="KeyFrame();">
<center>This example uses a <STRONG>Keyframe</STRONG>-based path to define its shape,<br> and utilizes the <STRONG>onmarker</STRONG> event to change the text on the page.<br> Current position of the path:</center>
<DIV id=Progress style="position:absolute; top:75; font-face: Verdana; font-size:18pt; color:black; text-align:center">
</DIV>

<!--This creates the Structured Graphic text used as the path target -->
<OBJECT ID="pthTarget"
CLASSID="clsid:369303C2-D7AC-11d0-89D5-00A0C90833E6" STYLE="position:absolute; TOP:100; LEFT:0; Width:200;height:100">
<PARAM NAME="Line0001" VALUE="SetFillColor(0,0,255)">
<PARAM NAME="Line0002" VALUE="SetFillStyle(1)">
<PARAM NAME="Line0003" VALUE="SetFont('target',40,650,0,0,0)">
<PARAM NAME="Line0004" VALUE="Text('path',0,0,0)">
</OBJECT>

<!--This creates the Path object used on the page, and sets some of its initial values -->
<OBJECT ID="PTH1"  
CLASSID = "CLSID:D7A7D7C3-D47F-11D0-89D3-00A0C90833E6">
	<PARAM NAME="AddTimeMarker1" value="0.0, First, 0">
	<PARAM NAME="AddTimeMarker2" value="9.0, Fourth, 0">
	<PARAM NAME="Repeat" VALUE="-1">
	<PARAM NAME="Relative" VALUE="1">
	<PARAM NAME="Target" VALUE="pthTarget">
</OBJECT>

</BODY>
</HTML>

