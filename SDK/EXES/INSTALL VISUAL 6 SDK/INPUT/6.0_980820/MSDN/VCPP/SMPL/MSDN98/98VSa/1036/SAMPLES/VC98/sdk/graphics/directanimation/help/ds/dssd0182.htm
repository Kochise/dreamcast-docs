<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>CAggDirectDraw Class</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0181.htm','/dssd0000.htm','/dssd0180.htm','/index.htm','/dssd0183.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="Lib_0001060202000000">CAggDirectDraw Class</A></H2>
<BR CLEAR=ALL>
<P><IMG SRC="art/vctl03.gif" WIDTH="259" HEIGHT="143" ALT="CAggDirectDraw class hierarchy" >

<P>This class aggregates an <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interface. Although DirectDraw&#174; interfaces (<B>IDirectDraw</B> and <A HREF="dssd0389.htm#external_00010a0109000059" TARGET="TEXT">IDirectDrawSurface</A>) potentially have the ability to be aggregated, this feature is not yet implemented. Various parts of Microsoft&#174; DirectShow&#153; require aggregation of the DirectDraw interfaces. In particular, the video renderer passes out media samples that expose <B>IDirectDraw</B> and <B>IDirectDrawSurface</B>. This class and the <A HREF="dssd0183.htm" TARGET="TEXT">CAggDrawSurface</A> class republish the methods of the DirectDraw class so that they can be aggregated.

<P>Each member function in this class, with the exception of the constructor, <A HREF="dssd0182.htm#Lib_0001060202040300" TARGET="TEXT">SetDirectDraw</A>, and <A HREF="dssd0182.htm#Lib_0001060202040200" TARGET="TEXT">NonDelegatingQueryInterface</A>,
simply calls the corresponding method on the <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interface with the parameters passed to it. 

<A NAME="Lib_0001060202010000"></A><P><B>Protected Data Members</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="Lib_0001060202010001">m_pDirectDraw</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DirectDraw object.
</FONT></TD></TR></TABLE>
<A NAME="Lib_0001060202020000"></A><P><B>Member Functions</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0182.htm#Lib_0001060202040100" TARGET="TEXT">CAggDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Constructs a <A HREF="dssd0182.htm" TARGET="TEXT">CAggDirectDraw</A> object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0182.htm#Lib_0001060202040300" TARGET="TEXT">SetDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the DirectDraw object to be aggregated by this class.
</FONT></TD></TR></TABLE>
<A NAME="Lib_0001060202030000"></A><P><B>Overridable Member Functions</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0182.htm#Lib_0001060202040200" TARGET="TEXT">NonDelegatingQueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns an interface and increments the reference count.
</FONT></TD></TR></TABLE>
<A NAME="Lib_0001060202040000"></A><P><B>Implemented IDirectDraw Methods</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000042" TARGET="TEXT">Compact</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Moves all the pieces of surface memory on the video card to a contiguous
block to make the largest chunk of free memory available.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000043" TARGET="TEXT">CreateClipper</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates a DirectDrawClipper object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000044" TARGET="TEXT">CreatePalette</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates a DirectDrawPalette object for this DirectDraw object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000045" TARGET="TEXT">CreateSurface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates a DirectDrawSurface object for this DirectDraw object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000046" TARGET="TEXT">DuplicateSurface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Duplicates a DirectDrawSurface object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a010900004e" TARGET="TEXT">EnumDisplayModes</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Enumerates all the display modes the hardware exposes through the DirectDraw object that are compatible with a provided surface description.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000047" TARGET="TEXT">EnumSurfaces</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Enumerates all the existing or possible surfaces that meet the search criterion specified.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000048" TARGET="TEXT">FlipToGDISurface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Makes the surface that GDI writes to the primary surface.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000049" TARGET="TEXT">GetCaps</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Fills in the raw (not remaining) capabilities of the device driver (the hardware) and/or the Hardware Emulation Layer (HEL).
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a010900004a" TARGET="TEXT">GetDisplayMode</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the current display mode.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a010900004b" TARGET="TEXT">GetFourCCCodes</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Gets the <A HREF="dssd0389.htm#external_00010a0109000030" TARGET="TEXT">FOURCC</A> codes supported by the DirectDraw object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a010900004c" TARGET="TEXT">GetGDISurface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the DirectDrawSurface object that currently represents the surface memory that GDI treats as the primary surface.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a010900004d" TARGET="TEXT">GetMonitorFrequency</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Points to a DirectDrawSurface pointer that will be made to point to
the DirectDrawSurface object currently controlling GDI's primary surface memory.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a010900004f" TARGET="TEXT">GetScanLine</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the scan line that the monitor is currently updating to the display.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000050" TARGET="TEXT">GetVerticalBlankStatus</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the status of the vertical blank.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000051" TARGET="TEXT">Initialize</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Initializes the DirectDraw object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000052" TARGET="TEXT">RestoreDisplayMode</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Resets the mode of the display device hardware for the primary surface to what it was
before the <A HREF="dssd0389.htm#external_00010a0109000007" TARGET="TEXT">CAggDirectDraw::SetDisplayMode</A> member function was called.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000053" TARGET="TEXT">SetCooperativeLevel</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Determines the top-level behavior of the application.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000054" TARGET="TEXT">SetDisplayMode</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the mode of the display device hardware.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000055" TARGET="TEXT">WaitForVerticalBlank</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Helps the caller synchronize itself with the vertical blank interval.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="Lib_0001060202040100">CAggDirectDraw::CAggDirectDraw</A></H3>
<A HREF="dssd0182.htm" TARGET="TEXT">CAggDirectDraw Class</A>
<P>Constructs a <A HREF="dssd0182.htm" TARGET="TEXT">CAggDirectDraw</A> object.

<P><B>CAggDirectDraw</B><B>(</B><BR>&nbsp;&nbsp;<B>TCHAR</B> <I>*pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pName</I>
 </DT><DD>Name of the object; used for debugging purposes.
</DD><DT><I>pUnk</I>
 </DT><DD>Pointer to the owner of this object. If non-NULL, <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A>
calls are delegated to this object.
</DD></DL>
<H5>Return Values</H5>
<P>No return value.
<H5>Remarks</H5>
<P>This member function calls the <A HREF="dssd0253.htm#Lib_0001060249030100" TARGET="TEXT">CUnknown::CUnknown</A> base class constructor
and sets the <A HREF="dssd0182.htm#Lib_0001060202010001" TARGET="TEXT">m_pDirectDraw</A> member variable to NULL.
<H3><HR COLOR=#0000FF><A NAME="Lib_0001060202040200">CAggDirectDraw::NonDelegatingQueryInterface</A></H3>
<A HREF="dssd0182.htm" TARGET="TEXT">CAggDirectDraw Class</A>
<P>Returns an interface and increments the reference count.

<P><B>HRESULT</B> <B>NonDelegatingQueryInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <B>**</B> <I>ppv</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>riid</I>
 </DT><DD>Reference identifier.
</DD><DT><I>ppv</I>
 </DT><DD>Pointer to the interface.
</DD></DL>
<H5>Return Values</H5>
<P>Returns a pointer to the interface.


<H5>Remarks</H5>
<P>This member function provides an implementation of the
<A HREF="dssd0265.htm#fmutil_0001060309000001" TARGET="TEXT">INonDelegatingUnknown::NonDelegatingQueryInterface</A> method.
By default it passes out references to <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> and then
calls the <A HREF="dssd0253.htm#Lib_0001060249030400" TARGET="TEXT">CUnknown::NonDelegatingQueryInterface</A> member function
for base class interface references. Override this class to return interfaces added
in the derived class.
<H3><HR COLOR=#0000FF><A NAME="Lib_0001060202040300">CAggDirectDraw::SetDirectDraw</A></H3>
<A HREF="dssd0182.htm" TARGET="TEXT">CAggDirectDraw Class</A>
<P>Sets the DirectDraw object to be aggregated by this class.

<P><B>void</B> <B>SetDirectDraw</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDIRECTDRAW</B> <I>pDirectDraw</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pDirectDraw</I>
 </DT><DD><A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> object to be aggregated.
</DD></DL>
<H5>Return Values</H5>
<P>No return value.
<H5>Remarks</H5>
<P>This member function sets the <A HREF="dssd0182.htm#Lib_0001060202010001" TARGET="TEXT">m_pDirectDraw</A> data member to the <I>pDirectDraw</I> parameter.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
