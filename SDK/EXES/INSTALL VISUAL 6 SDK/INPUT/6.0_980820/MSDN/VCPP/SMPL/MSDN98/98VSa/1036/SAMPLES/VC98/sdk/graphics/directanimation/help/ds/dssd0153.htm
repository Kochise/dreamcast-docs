<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IMediaFilter Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0152.htm','/dssd0000.htm','/dssd0088.htm','/index.htm','/dssd0154.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_0001060141000000">IMediaFilter Interface</A></H2>
<BR CLEAR=ALL>
<P>Multimedia components that provide time-based data expose the <B>IMediaFilter</B>
interface. This interface abstracts an object that processes time-based data streams and
represents a multimedia device (possibly implemented in software). It
controls the active or running state of the object and the synchronization of this
state with other objects in the system.

<P>This interface inherits the <A HREF="dssd0389.htm#external_00010a0109000089" TARGET="TEXT">IPersist</A> interface.

<A NAME="If_0001060141010000"></A><P><B>When to Implement</B>
<P>Methods on this interface should be implemented as part of any filter. This is
typically done by using the base class <A HREF="dssd0194.htm#Lib_000106020e000000" TARGET="TEXT">CBaseFilter</A>, which implements
<A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> and <A HREF="dssd0153.htm" TARGET="TEXT">IMediaFilter</A>.

<A NAME="If_0001060141020000"></A><P><B>When to Use</B>
<P>Because the <A HREF="dssd0153.htm" TARGET="TEXT">IMediaFilter</A> interface is inherited by the <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> interface,
which adds other necessary methods required to be exported by filters, this
interface is not normally used directly by the filter graph manager or other filters.
It can, however, be of use to plug-in distributors. For example, the filter graph manager internally exports <B>IMediaFilter</B>; its plug-in distributor exports <A HREF="dssd0149.htm" TARGET="TEXT">IMediaControl</A> and calls the 
<B>IMediaFilter</B> methods to implement its own methods.

<A NAME="If_0001060141030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IMediaFilter methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0153.htm#If_0001060141030600" TARGET="TEXT">Stop</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Informs the filter to transition to the new (stopped) state.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0153.htm#If_0001060141030300" TARGET="TEXT">Pause</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Informs the filter to transition to the new (paused) state.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0153.htm#If_0001060141030400" TARGET="TEXT">Run</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Informs the filter to transition to the new (running) state.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0153.htm#If_0001060141030100" TARGET="TEXT">GetState</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Determines the state of the filter.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0153.htm#If_0001060141030500" TARGET="TEXT">SetSyncSource</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Identifies the reference clock to which the filter should synchronize activity.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0153.htm#If_0001060141030200" TARGET="TEXT">GetSyncSource</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the current reference clock (or NULL if there is no clock).
Passes a time value to synchronize independent streams.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="If_0001060141030100">IMediaFilter::GetState</A></H3>
<A HREF="dssd0153.htm" TARGET="TEXT">IMediaFilter Interface</A>
<P>Determines the filter's state.

<P><B>HRESULT</B> <B>GetState</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwMilliSecsTimeout</I><B>,</B><BR>&nbsp;&nbsp;<B>FILTER_STATE</B> <B>*</B> <I>State</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>dwMilliSecsTimeout</I>
</DT><DD>[in] Duration of the time-out, in milliseconds. To block indefinitely, pass INFINITE.
</DD><DT><I>State</I>
</DT><DD>[out] Returned state of the filter. States include stopped, paused,
running, or intermediate (in the process of changing).
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if the state is running, paused, or inactive; otherwise,
returns <A HREF="dssd0293.htm#errcodes_0001060a01000060" TARGET="TEXT">VFW_S_STATE_INTERMEDIATE</A> if the transition is not complete
(the time-out expired). The state returned in the latter case is the one being changed to.

<H5>Remarks</H5>
<P>Usually, renderer filters will return <A HREF="dssd0293.htm#errcodes_0001060a01000060" TARGET="TEXT">VFW_S_STATE_INTERMEDIATE</A> until they receive 
enough data to render at least one sample. In some circumstances, a filter will 
find that it can supply data on all of its output streams. This
condition usually occurs because of unusual or bad data. An example of unusual data 
might be an MPEG slide show, where video frames occur infrequently in the data but audio is 
continuous. In this case, 

a video frame in the video stream might not be found until
a certain spot in the audio stream. If the filter discovers that it cannot complete the 
state change (for this or any other reason), it can return <A HREF="dssd0293.htm#errcodes_0001060a01000087" TARGET="TEXT">VFW_S_CANT_CUE</A>. 

<P>When an application calls the filter graph manager's <A HREF="dssd0149.htm#If_000106013d030400" TARGET="TEXT">IMediaControl::GetState</A> method,
the filter graph manager calls <B>GetState</B> on the filter and
continues to poll. If the filter graph manager receives <A HREF="dssd0293.htm#errcodes_0001060a01000087" TARGET="TEXT">VFW_S_CANT_CUE</A> back from the filter, 
it returns this value to the application from its <B>IMediaControl::GetState</B> method. 

<H3><HR COLOR=#0000FF><A NAME="If_0001060141030200">IMediaFilter::GetSyncSource</A></H3>
<A HREF="dssd0153.htm" TARGET="TEXT">IMediaFilter Interface</A>
<P>Retrieves the current reference clock in use by this filter.

<P><B>HRESULT</B> <B>GetSyncSource</B><B>(</B><BR>&nbsp;&nbsp;<B>IReferenceClock</B> <B>**</B> <I>pClock</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pClock</I>
</DT><DD>[out] Pointer to a reference clock; it will be set to the <A HREF="dssd0170.htm" TARGET="TEXT">IReferenceClock</A> interface.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>The returned interface (if it is non-NULL) will have a reference added by the
<A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">IUnknown::AddRef</A> method. The calling application should release the interface
by calling the <A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">IUnknown::Release</A> method when it has finished with the pointer.
<H3><HR COLOR=#0000FF><A NAME="If_0001060141030300">IMediaFilter::Pause</A></H3>
<A HREF="dssd0153.htm" TARGET="TEXT">IMediaFilter Interface</A>
<P>Informs the filter to transition to the new state.

<P><B>HRESULT</B> <B>Pause</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns S_OK if the transition is complete; otherwise, returns one of the following values.

<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>Error</I> value </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Transition failed.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">S_FALSE </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Transition is not complete, but no error has occurred.
</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P>The state transition might not be immediate (external mechanical activity
might be involved, for example). The state method might return before the transition has
completed.
<H3><HR COLOR=#0000FF><A NAME="If_0001060141030400">IMediaFilter::Run</A></H3>
<A HREF="dssd0153.htm" TARGET="TEXT">IMediaFilter Interface</A>
<P>Informs the filter to transition to the new (running) state.
Passes a time value to synchronize independent streams.

<P><B>HRESULT</B> <B>Run</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStart</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>tStart</I>
</DT><DD>Time value of the reference clock.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>The <I>tStart</I> parameter is the amount to be added to the <A HREF="dssd0156.htm" TARGET="TEXT">IMediaSample</A>
time stamp to determine the time at which that sample should be rendered according to the
reference clock. That is, it is the reference time at which a sample with a stream time of
zero should be rendered.

<P>For example, the time value for the beginning of the stream is the time at
which the first sample should appear. If the application restarts from paused mode in
midstream, <I>tStart</I> is the amount of time paused, plus the start time.

<P>The filter graph provides this information to its filters. An application
calling the filter graph may pass a start time of zero, in which case the filter
graph calculates a time that will begin as soon as possible. Filter graphs accept zero to mean
as soon as possible; most filters do not.
<H3><HR COLOR=#0000FF><A NAME="If_0001060141030500">IMediaFilter::SetSyncSource</A></H3>
<A HREF="dssd0153.htm" TARGET="TEXT">IMediaFilter Interface</A>
<P>Identifies the reference clock to which the filter should synchronize activity.

<P><B>HRESULT</B> <B>SetSyncSource</B><B>(</B><BR>&nbsp;&nbsp;<B>IReferenceClock</B> <B>*</B> <I>pClock</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pClock</I>
</DT><DD>[in] Pointer to the <A HREF="dssd0170.htm" TARGET="TEXT">IReferenceClock</A> interface.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method is of most importance to rendering filters and might not apply to other filters.
The <I>pClock</I> parameter can be NULL, meaning that the filter should run as fast as
possible at its current quality settings without any attempt to synchronize. For example, a
filter graph that is doing compression probably runs in this mode. Each filter
takes as long as it needs.
<H3><HR COLOR=#0000FF><A NAME="If_0001060141030600">IMediaFilter::Stop</A></H3>
<A HREF="dssd0153.htm" TARGET="TEXT">IMediaFilter Interface</A>
<P>Informs the filter to transition to the new state.

<P><B>HRESULT</B> <B>Stop</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns S_OK if the transition is complete; otherwise, returns one of the following values.

<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>Error</I> value </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Transition failed.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">S_FALSE </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Transition is not complete, but no error has occurred.
</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P>The state transition might not be immediate (external mechanical activity might be involved,
for example). The state functions might return before the transition has completed.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
