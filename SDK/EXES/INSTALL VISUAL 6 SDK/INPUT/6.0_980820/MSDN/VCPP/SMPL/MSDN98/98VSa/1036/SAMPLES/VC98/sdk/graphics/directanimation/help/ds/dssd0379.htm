<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectDraw3 Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0378.htm','/dssd0000.htm','/dssd0376.htm','/index.htm','/dssd0380.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="ddrawex_0001090103000000">IDirectDraw3 Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IDirectDraw3</B> interface is available to applications that have created a DirectDraw object through the <A HREF="dssd0378.htm#ddrawex_0001090102030100" TARGET="TEXT">IDirectDrawFactory::CreateDirectDraw</A> method. This method retrieves the address of a pointer to an <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interface, which your application can use to query for the <B>IDirectDraw3</B> interface. 



<P>The <B>IDirectDraw3</B> interface extends the <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> and the <A HREF="dssd0389.htm#external_00010a0109000056" TARGET="TEXT">IDirectDraw2</A> interfaces by adding the <A HREF="dssd0379.htm#ddrawex_0001090103030200" TARGET="TEXT">IDirectDraw3::GetSurfaceFromDC</A> method and providing new behavior for the <A HREF="dssd0379.htm#ddrawex_0001090103030100" TARGET="TEXT">IDirectDraw3::CreateSurface</A> method (formerly <A HREF="dssd0389.htm#external_00010a0109000057" TARGET="TEXT">IDirectDraw2::CreateSurface</A>). This section provides information on the new behavior of the <A HREF="dssd0379.htm#ddrawex_0001090103030100" TARGET="TEXT">CreateSurface</A> method. Consult the DirectX SDK for information on the original behavior of this and all other <B>IDirectDraw</B> and <B>IDirectDraw2</B> methods as they relate to DirectDraw objects.

<P>For more information on additional functionality provided by DirectDrawEx, see <A HREF="dssd0377.htm" TARGET="TEXT">Using DirectDrawEx</A>.

<A NAME="ddrawex_0001090103010000"></A><P><B>When to Implement</B>
<P>Do not implement this interface; DirectDrawEx implements it for you. 



<A NAME="ddrawex_0001090103020000"></A><P><B>When to Use</B>
<P>Applications use this interface when they have created a DirectDraw object through a successful call to the <A HREF="dssd0378.htm#ddrawex_0001090102030100" TARGET="TEXT">IDirectDrawFactory::CreateDirectDraw</A> method. Applications can use this interface to get an <A HREF="dssd0389.htm#external_00010a0109000059" TARGET="TEXT">IDirectDrawSurface</A> interface pointer directly from a handle to a device context.

<A NAME="ddrawex_0001090103030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IDirectDraw3 methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0379.htm#ddrawex_0001090103030100" TARGET="TEXT">CreateSurface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates a DirectDrawSurface object from a DirectDraw object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0379.htm#ddrawex_0001090103030200" TARGET="TEXT">GetSurfaceFromDC</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a pointer to an <A HREF="dssd0389.htm#external_00010a0109000059" TARGET="TEXT">IDirectDrawSurface</A> interface from a handle to a device context.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="ddrawex_0001090103030100">IDirectDraw3::CreateSurface</A></H3>
<A HREF="dssd0379.htm" TARGET="TEXT">IDirectDraw3 Interface</A>
<P>Creates a DirectDrawSurface object from a DirectDraw object.

<P><B>STDMETHOD</B> <B>CreateSurface</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDDSURFACEDESC</B> <I>lpDDSurfaceDesc</I><B>,</B><BR>&nbsp;&nbsp;<B>LPDIRECTDRAWSURFACE</B> <B>FAR</B> <I>*lpDDSurface</I><B>,</B><BR>&nbsp;&nbsp;<B>IUnknown</B> <B>FAR</B> <I>*pUnkOuter</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpDDSurfaceDesc</I>
 </DT><DD>[in] Pointer to the <A HREF="dssd0389.htm#external_00010a010900001d" TARGET="TEXT">DDSURFACEDESC</A> structure that describes the requested surface. You should set any unused members of <B>DDSURFACEDESC</B> to zero before calling this method. A <A HREF="dssd0389.htm#external_00010a010900001c" TARGET="TEXT">DDSCAPS</A> structure is a member of <B>DDSURFACEDESC</B>.



</DD><DT><I>lpDDSurface</I>
 </DT><DD>[out] Address of a pointer to be initialized with a valid DirectDrawSurface pointer if the call succeeds.
</DD><DT><I>pUnkOuter</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A> interface on an outer object that will be aggregated with an inner object's <B>IUnknown</B> interface.

</DD></DL>
<H5>Return Values</H5>
<P>Returns DD_OK if successful, or one of the following error values otherwise: 
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INCOMPATIBLEPRIMARY </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The primary surface creation request does not match the existing primary surface. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INVALIDCAPS </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">One or more of the capability bits passed to the callback function are incorrect. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INVALIDOBJECT </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DirectDraw received a pointer to an invalid DirectDraw object. 



</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INVALIDPARAMS </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">One or more of the parameters passed to the method are incorrect. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INVALIDPIXELFORMAT </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The pixel format was invalid as specified. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_NOALPHAHW </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">No alpha acceleration hardware is present or available, which caused the requested operation to fail. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_NOCOOPERATIVELEVELSET </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The <A HREF="dssd0389.htm#external_00010a0109000058" TARGET="TEXT">IDirectDraw2::SetCooperativeLevel</A> method was not called before the surface was created.



</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_NODIRECTDRAWHW </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Hardware-only DirectDraw object creation isn't possible; the driver doesn't support any hardware. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_NOEMULATION </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Software emulation isn't available. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_NOEXCLUSIVEMODE </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The operation requires the application to have exclusive mode, but the application doesn't have exclusive mode. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_NOFLIPHW </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Flipping visible surfaces isn't supported. 



</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_NOMIPMAPHW </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The operation can't be carried out because no bitmap



 texture mapping hardware is present or available. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_NOOVERLAYHW </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The operation can't be carried out because no overlay hardware is present or available. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_NOZBUFFERHW </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The operation to create a z-buffer in display memory or to perform a blit using a z-buffer can't be carried out because there is no hardware support for z-buffers. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_OUTOFMEMORY </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DirectDraw doesn't have enough available memory to perform the operation. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_OUTOFVIDEOMEMORY </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DirectDraw doesn't have enough display memory to perform the operation. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_PRIMARYSURFACEALREADYEXISTS </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The application has already created a primary surface. 



</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_UNSUPPORTEDMODE </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The operation isn't supported. 
</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P>Passing in NULL for the <I>pUnkOuter</I> parameter will return the address of a DirectDraw surface in the <I>lpDDSurface</I> parameter. However, if you pass in a pointer to an outer interface you want to aggregate with an inner interface, you will get back an <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A> pointer for the <I>lpDDSurface</I> parameter.

<P>DirectDrawEx now also provides the DDSCAPS_DATAEXCHANGE flag for the <I>dwcaps</I> member of the <A HREF="dssd0389.htm#external_00010a010900001c" TARGET="TEXT">DDSCAPS</A> structure, which is defined as DDSCAPS_SYSTEMMEMORY|DDSCAPS_VIDEOMEMORY in Ddrawex.h.




Setting this flag in conjunction with the DDSCAPS_OWNDC flag enables applications to call the <A HREF="dssd0389.htm#external_00010a0109000068" TARGET="TEXT">IDirectDrawSurface::GetDC</A> method to lock the device context for as long they require, without holding a lock on the surface.



<P>This method calls the <A HREF="dssd0389.htm#external_00010a0109000045" TARGET="TEXT">IDirectDraw::CreateSurface</A> and <A HREF="dssd0389.htm#external_00010a0109000057" TARGET="TEXT">IDirectDraw2::CreateSurface</A> methods.



<H3><HR COLOR=#0000FF><A NAME="ddrawex_0001090103030200">IDirectDraw3::GetSurfaceFromDC</A></H3>
<A HREF="dssd0379.htm" TARGET="TEXT">IDirectDraw3 Interface</A>
<P>Retrieves a pointer to an <A HREF="dssd0389.htm#external_00010a0109000059" TARGET="TEXT">IDirectDrawSurface</A> interface from a handle to a device context.

<P><B>STDMETHOD</B> <B>GetSurfaceFromDC</B><B>(</B><BR>&nbsp;&nbsp;<B>HDC</B> <I>hdc</I><B>,</B><BR>&nbsp;&nbsp;<B>IDirectDrawSurface</B> <I>**ppSurface</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B><BR><H5>Parameters</H5>
<DL><DT><I>hdc</I>
 </DT><DD>[in] Handle of the device context (DC).
</DD><DT><I>ppSurface</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="dssd0389.htm#external_00010a0109000059" TARGET="TEXT">IDirectDrawSurface</A> interface.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful, or one of the following values otherwise:
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_POINTER </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Invalid pointer to <A HREF="dssd0389.htm#external_00010a0109000059" TARGET="TEXT">IDirectDrawSurface</A>.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_NOTFOUND </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The requested item wasn't found. 
</FONT></TD></TR></TABLE>

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
