<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Sequencer Control</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/DA_E0018.htm','/DA_E0000.htm','/DA_E0017.htm','/index.htm','/DA_E0020.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="daseq_0001040103000000">Sequencer Control</A></H2>
<BR CLEAR=ALL>
<P>This section contains reference material for the sequencer control and its methods and events, plus the following additional topics: 
<UL><LI><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103010000" TARGET="TEXT">Sequencer Control VBScript Example</A>
<LI><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020000" TARGET="TEXT">Action Set</A>
</UL>
<P>The Sequencer control provides timing and sequencing services for <A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020000" TARGET="TEXT">action sets</A>, scripts used to control Microsoft&#174; ActiveX&#153; Controls or scripts on the page. The sequencer calls Microsoft JScript&#153;, Microsoft Visual Basic(r) Scripting Edition (VBScript) or other Web scripts.


<P>These procedures are called by the sequencer's <A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020300" TARGET="TEXT">At Method</A> and can be performed once or they can be looped by the sequencer. The sequencer calls the named script with the parameter string and the resolved parameter string is executed. Note that this means unresolved parameters don't get executed.

<P>To use the sequencer object, you must first instantiate it on the HTML page, as shown in the following syntax:




<P><B>Syntax</B>
<PRE><FONT FACE="Courier" SIZE="2">
&lt;OBJECT id=object 
&#009;STYLE=""
&#009;CLASSID=clsid:B0A6BAE2-AAF0-11d0-A152-00A0C908DB96&gt;
&lt;/OBJECT&gt;
</FONT></PRE>
<P><B>Parameters</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>object</I>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Name of the sequencer, to be used in script.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Method


 </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020300" TARGET="TEXT">At</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Specifies a new action in the action set.


</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020400" TARGET="TEXT">Pause</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Stops action set playback at current position. Keeps time pointer and queue.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020500" TARGET="TEXT">Play</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Starts the action set (if stopped). Resumes sequencer playback if sequencer is paused. Ignored if sequencer is playing.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020600" TARGET="TEXT">Seek</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Changes the current playback position of the action set to a new, specified time.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020700" TARGET="TEXT">Stop</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Stops action set playback, resets its playback position to the beginning.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Event</B></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description</B></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Parameters
</B></FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020800" TARGET="TEXT">OnInit</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Occurs when sequencer is first completely loaded into memory.</FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"></FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020900" TARGET="TEXT">OnPause</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Occurs when action set playback has been paused.</FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Name of action set
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020a00" TARGET="TEXT">OnPlay</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Occurs when the action set has started playback. This event is only called when the action set starts playback from a stopped or paused state, not when a currently playing action set loops back to the beginning to repeat playback.</FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Name of action set
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020b00" TARGET="TEXT">OnSeek</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Occurs after the <A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020600" TARGET="TEXT">Seek</A> method call has been completed.</FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Name of action set, new time
</FONT></TD>
</TR>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020c00" TARGET="TEXT">OnStop</A></FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Occurs when the action set playback ends or is stopped.</FONT></TD>
<TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Name of action set
</FONT></TD>
</TR>
</TABLE>
<P>For optimal performance, use only one sequencer on a page with a single action set that calls a lot of actions. You can run multiple sequencers that each execute fewer action sets simultaneously but will get better performance with a single sequencer executing a larger number of action sets.

<P>As the page is loaded, the sequencers used are loaded into memory. You can use the <A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020800" TARGET="TEXT">OnInit Event</A> to ensure that the sequencers are fully loaded before starting their playback.


<A NAME="daseq_0001040103010000"></A><P><B>Sequencer Control VBScript Example


</B>
<PRE><FONT FACE="Courier" SIZE="2">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Microsoft DirectAnimation Controls - Sequencer&lt;/TITLE&gt;

&lt;SCRIPT LANGUAGE=VBSCRIPT&gt;

Sub Window_OnLoad
&#009;call sgMSDHTML.SetIdentity
&#009;Button1.value="Pause"
End Sub

Sub Seq_oninit
&#009;call seq("ActionSet1").At(0.000, "RotateAll",-1, 0.050, 1)
&#009;Call Seq("ActionSet1").Play
End Sub

Sub RotateAll
&#009;Call sgMSDHTML.Rotate(0,9,2)
End Sub

Sub Start
&#009;Select Case Button1.value
&#009;Case "Play"
&#009;&#009;Call Seq("ActionSet1").Play
&#009;&#009;Button1.value="Pause"
&#009;Case "Pause"
&#009;&#009;Call Seq("ActionSet1").Pause
&#009;&#009;Button1.value="Play"
&#009;End Select
End Sub

&lt;/SCRIPT&gt;
&lt;/HEAD&gt;


&lt;BODY BGCOLOR=BLACK&gt;

&lt;OBJECT ID=sgMSDHTML
STYLE="POSITION: ABSOLUTE; HEIGHT:300;WIDTH:450;TOP:100;LEFT:60;VISIBILITY:VISIBLE; ZINDEX:-1" 
CLASSID="CLSID:369303C2-D7AC-11d0-89D5-00A0C90833E6"&gt;
&lt;PARAM NAME="Line0001" VALUE="SetLineColor(255,255,255)"&gt;
&lt;PARAM NAME="Line0002" VALUE="SetFillColor(0,0,255)"&gt;
&lt;PARAM NAME="Line0003" VALUE="SetFillSTYLE(1)"&gt;
&lt;PARAM NAME="Line0004" VALUE="SetLineSTYLE(1)"&gt;
&lt;PARAM NAME="Line0005" VALUE="SetFont('Verdana',60,650,0,0,0)"&gt;
&lt;PARAM NAME="Line0006" VALUE="Text('Microsoft', -120, -100, 0)"&gt;
&lt;PARAM NAME="Line0007" VALUE="Text('Dynamic', -120, -50, 0)"&gt;
&lt;PARAM NAME="Line0008" VALUE="Text('HTML', -90, 0, 0)"&gt;
&lt;PARAM NAME="Line0009" VALUE="Text('Multimedia', -120, 50, 0)"&gt;
&lt;/OBJECT&gt;

&lt;OBJECT ID="Seq"
&#009;CLASSID="CLSID:B0A6BAE2-AAF0-11d0-A152-00A0C908DB96"
&#009;STYLE="WIDTH:2;HEIGHT:2"&gt;
&lt;/OBJECT&gt;

&lt;INPUT TYPE=button ID="Button1"
STYLE="POSITION:ABSOLUTE; TOP:10; LEFT:10; z-index:2; VALUE=""; OnClick="Start"&gt; 

&lt;/BODY&gt;
&lt;/HTML&gt;
</FONT></PRE>
<A NAME="daseq_0001040103020000"></A><P><B>Action Set</B>
<P>An <I>action set</I> is a logical grouping of named procedures that are used to control the timing and behavior of objects on the page. Action sets have the following properties:
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name
 </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020100" TARGET="TEXT">PlayState</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the current playback state of the action set: 0=stopped, 1=playing, 2=paused. Read-only at run time.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020200" TARGET="TEXT">Time</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the elapsed time in format seconds/milliseconds (SS.MSS)


 since the start of action set playback, including iterations. The default setting is zero. Read-only at run time.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020100">PlayState Property</A></H3>
<A HREF="DA_E0019.htm#daseq_0001040103020000" TARGET="TEXT">Action Set</A>
<P>Retrieves the state of the sequencer. Read-only at run time.


<P><BR><B>VBScript</B> <B>Syntax</B><BR><BR><B>playstate</B> <B>=</B> <B>object</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B> <B>.PlayState</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><BR><B>playstate</B> <B>=</B> <B>object.item</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B> <B>.Playstate</B><BR><H5>Parameters</H5>
<DL><DT><I>object</I>
 </DT><DD>Name of sequencer.
</DD><DT><I>actionsetname</I>
 </DT><DD>Name of the action set.
</DD><DT><I>playState</I>


 </DT><DD>Integer return value that indicates the sequencer's play state. Possible values are 0 (stopped), 1 (playing) or 2 (paused).


</DD></DL>
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020200">Time Property</A></H3>
<A HREF="DA_E0019.htm#daseq_0001040103020000" TARGET="TEXT">Action Set</A>
<P>Represents the amount of time since the start of the sequencer's playback. Read-only at run time.



<P><BR><B>VBScript</B> <B>Syntax</B><BR><BR><B>Time</B> <B>=</B> <B>object</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B> <B>.Time</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><BR><B>Time</B> <B>=</B> <B>object.item</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B> <B>.Time</B><BR><H5>Parameters</H5>
<DL><DT><I>object</I>
 </DT><DD>Name of sequencer.
</DD><DT><I>actionsetname</I>
 </DT><DD>Name of the action set.
</DD><DT><I>Time</I>
 </DT><DD>Return value - float, format seconds.milliseconds (s.mss), the elapsed sequencer playback time.


</DD></DL>
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020300">At Method</A></H3>
<A HREF="DA_E0019.htm" TARGET="TEXT">Sequencer Control</A>
<P>Specifies an action to take place within an action set.

<P><BR><B>VBScript</B> <B>Syntax</B><BR><BR><B>call</B> <B>object</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B><B>.At</B><B>(</B><BR>&nbsp;&nbsp;<I>time</I><B>,</B><BR>&nbsp;&nbsp;<I>&quot;script&quot;</I><B>,</B><BR>&nbsp;&nbsp;<I>[loop</I><B>,</B><BR>&nbsp;&nbsp;<I>interval</I><B>,</B><BR>&nbsp;&nbsp;<I>tiebreak</I><B>,</B><BR>&nbsp;&nbsp;<B>drop</B> <I>threshold]</I><BR>&nbsp;&nbsp;<B>)</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><BR><B>object.item</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B><B>.At</B><B>(</B><BR>&nbsp;&nbsp;<I>time</I><B>,</B><BR>&nbsp;&nbsp;<I>&quot;script&quot;</I><B>,</B><BR>&nbsp;&nbsp;<I>[loop</I><B>,</B><BR>&nbsp;&nbsp;<I>interval</I><B>,</B><BR>&nbsp;&nbsp;<I>tiebreak</I><B>,</B><BR>&nbsp;&nbsp;<B>drop</B> <I>threshold]</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>object</I>
 </DT><DD>Name of sequencer.
</DD><DT><I>actionsetname</I>
 </DT><DD>Name of the action set.
</DD><DT><I>time</I>
 </DT><DD>Required. Double value in seconds.milliseconds (SS.MSS) format. Sets the start time for the specified action. 
</DD><DT><I>script</I>
 </DT><DD>Required. Text string identifying the named procedure to be called. Can pass parameters as part of the script call, for example, <I>script</I>(<B>param1</B>)
</DD><DT><I>loop</I>
 </DT><DD>Optional. Integer. Sets the loop count for this action. The default is 1. If set to &#150;1, looping is infinite. Any negative number other than &#150;1 will be treated as 0. Zero loop count value prevents execution. You can use this to programmatically halt action set execution. 
</DD><DT><I>interval</I>
 </DT><DD>Optional. Double value in seconds.milliseconds (SS.MSS) format. Sets the delay between iterations of this action.


 Minimum interval resolution is 20 milliseconds (00.020). The default is 33 milliseconds (00.033), equivalent to 30 frames per second.
</DD><DT><I>tie break</I>


 </DT><DD>Optional. Integer, &#150;1(default), 0-n.


 Sets the priority for the action. In the event that two actions happen at the same time, the action with the lower tie break number


 will be performed first. Zero is the highest priority action that can be dropped; -1 is the lowest-priority action and will be executed last.
</DD><DT><I>drop threshold</I>
 </DT><DD>Optional. Double value in seconds.milliseconds (SS.MSS) format. Sets the time by which the action must be performed before it is dropped from the queue. The default value is for the action to never be dropped (&#150;1.000).
</DD></DL>
<H5>Remarks</H5>
<P>The <I>drop threshold</I> parameter is useful for optimizing sequencer performance by streamlining the number of actions that the sequencer has to perform at any given moment; for instance, when starting up a complex action set. Thoughtful use of this parameter can keep the sequencer from slowing down or speeding up from backlog of actions to be executed, and keep the timing of actions within reasonable tolerances.
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020400">Pause Method</A></H3>
<A HREF="DA_E0019.htm" TARGET="TEXT">Sequencer Control</A>
<P>Stops the sequencer's playback, but maintains the current playback position.

<P><BR><B>VBScript</B> <B>syntax</B><BR><B>call</B> <B>object</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B> <B>.Pause</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><B>object.item</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B><B>.Pause</B><B>(</B> <B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>object</I>
 </DT><DD>Name of sequencer.
</DD><DT><I>actionsetname</I>
 </DT><DD>Name of the action set.
</DD></DL>
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020500">Play Method</A></H3>
<A HREF="DA_E0019.htm" TARGET="TEXT">Sequencer Control</A>
<P>Starts the sequencer or resumes it if the sequencer was paused. If the sequencer is playing, the call is ignored.

<P><BR><B>VBScript</B> <B>Syntax</B><BR><BR><B>call</B> <B>object</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B> <B>.Play</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><B>object.item</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B><B>.Play</B><B>(</B> <B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>object</I>
 </DT><DD>Name of sequencer.
</DD><DT><I>actionsetname</I>
 </DT><DD>Name of the action set.
</DD></DL>
<H5>Remarks</H5>
<P>The following example starts a sequencer described by the Seq object when the page loads. This sequencer calls the MoveButton action set at time 0, and calls the named procedure MoveButton.

<PRE><FONT FACE="Courier" SIZE="2">
&lt;SCRIPT LANGUAGE=vbscript&gt;
&lt;!--
Sub window_onLoad
&#009;Call Seq("MoveButton").Play
End Sub
--&gt;
&lt;/SCRIPT&gt;
</FONT></PRE>
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020600">Seek Method</A></H3>
<A HREF="DA_E0019.htm" TARGET="TEXT">Sequencer Control</A>
<P>Changes the current playback position of the Sequencer to another specified point in playback.
<P><BR><B>VBScript</B> <B>Syntax</B><BR><BR><B>call</B> <B>object</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B><B>.Seek</B><B>(</B><BR>&nbsp;&nbsp;<I>time</I><BR>&nbsp;&nbsp;<B>)</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><BR><B>object.item</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B><B>.Seek</B><B>(</B><BR>&nbsp;&nbsp;<I>time</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>object</I>
 </DT><DD>Name of sequencer.
</DD><DT><I>actionsetname</I>
 </DT><DD>Name of the action set.
</DD><DT><I>time</I>
 </DT><DD>New time for sequencer to continue playback.
</DD></DL>
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020700">Stop Method</A></H3>
<A HREF="DA_E0019.htm" TARGET="TEXT">Sequencer Control</A>
<P>Stops the sequencer and resets its position to the beginning.
<P><BR><B>VBScript</B> <B>Syntax</B><BR><BR><B>call</B> <B>object</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B> <B>.Stop</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><BR><B>object.item</B><B>(</B><BR>&nbsp;&nbsp;<I>&quot;actionsetname&quot;</I><BR>&nbsp;&nbsp;<B>)</B><B>.Stop</B><B>(</B> <B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>object</I>
 </DT><DD>Name of the sequencer.
</DD><DT><I>actionsetname</I>
 </DT><DD>Name of the action set.
</DD></DL>
<H5>Remarks</H5>
<P>The following example stops the sequence when the <FONT FACE="Courier New">btnEnd</FONT> button is clicked.


<PRE><FONT FACE="Courier" SIZE="2">
&lt;SCRIPT LANGUAGE=vbscript&gt;
&lt;!--
Sub btnEnd_OnClick
&#009;Call Seq("MoveButton").Stop
End Sub
--&gt;
&lt;/SCRIPT&gt;
</FONT></PRE>
<P>The sequencer automatically stops when the page is unloaded.
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020800">OnInit Event</A></H3>
<A HREF="DA_E0019.htm" TARGET="TEXT">Sequencer Control</A>
<P>Called when the page is loaded, when the sequencer has finished loading into memory.


 At this point, the <I>script</I>


 is executed.


 This event is generally used to load the rest of the procedures to be run on the client side.

<P><BR><B>VBScript</B> <B>Syntax</B><BR><BR><B>Sub</B> <B>object_oninit</B><BR><B>script</B><BR><B>End</B> <B>Sub</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><BR>&lt;<B>script</B> <B>language=&quot;javascript&quot;</B> <B>for=&quot;object&quot;</B> <B>event=&quot;oninit&quot;&gt;</B><BR>&lt;<B>!--</B><BR><B>script</B><BR>&nbsp;&nbsp;//-->&lt;<B>script&gt;</B><BR><H5>Parameters</H5>
<DL><DT><I>object</I>
 </DT><DD>Name of the sequencer to be used in script.
</DD><DT><I>script</I>
 </DT><DD>Script to be executed.
</DD></DL>
<H5>Remarks</H5>
<P>The following example shows the <B>oninit</B> event used to play SeqMgr once it has finished loading the other sequencers that it controls. In the example, SeqMgr controls Seq1_Action1.
<PRE><FONT FACE="Courier" SIZE="2">
&lt;SCRIPT LANGUAGE="VBScript"&gt;
&lt;!--
Sub SeqMgr_oninit()
&#009;Call SeqMgr("ActionSet1").At(0.000,"Seq1_Action1",300,0.100,1,100.000)
&#009;Call SeqMgr("ActionSet1").Play
End Sub
--&gt;
&lt;/SCRIPT&gt;
</FONT></PRE>
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020900">OnPause Event</A></H3>
<A HREF="DA_E0019.htm" TARGET="TEXT">Sequencer Control</A>
<P>Called when the sequencer playback is paused. At this point, the <I>script</I> is executed.


<P><BR><B>VBScript</B> <B>Syntax</B><BR><BR><B>Sub</B> <B>object_onpause</B><B>(</B><BR>&nbsp;&nbsp;<I>actionsetname</I><BR>&nbsp;&nbsp;<B>)</B><BR><B>script</B><BR><B>End</B> <B>Sub</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><BR>&lt;<B>script</B> <B>language=&quot;javascript&quot;</B> <B>for=&quot;object&quot;</B> <B>event=&quot;onpause</B><B>(</B><BR>&nbsp;&nbsp;<I>actionsetname</I><BR>&nbsp;&nbsp;<B>)</B> <B>&quot;&gt;</B><BR>&lt;<B>!--</B><BR><B>script</B><BR>&nbsp;&nbsp;//-->&lt;<B>script&gt;</B><BR><H5>Parameters</H5>
<DL><DT><I>object</I>
 </DT><DD>Name of the paused sequencer.
</DD><DT><I>ActionSet</I>


 </DT><DD>Name of the action set that has been paused as a consequence of the sequencer being paused.


</DD></DL>
<H5>Remarks</H5>
<P>The following example tests the actionsetname parameter passed (a variable set to the name of the action set last paused) conditionally executes a script based on which action set has been paused.


<PRE><FONT FACE="Courier" SIZE="2">
Sub Sequencername_onpause(actionsetname)
&#009;If actionsetname = "ActionSet1" then
&#009;&#009;button1.value = "Play"
&#009;Else
&#009;&#009;button1.value="Pause"
&#009;Endif
End Sub
</FONT></PRE>
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020a00">OnPlay Event</A></H3>
<A HREF="DA_E0019.htm" TARGET="TEXT">Sequencer Control</A>
<P>Occurs when the sequencer starts playback. At this point, the <I>script</I> is executed.
<P><BR><B>VBScript</B> <B>Syntax</B><BR><B>Sub</B> <B>SequencerName_onplay</B><B>(</B><BR>&nbsp;&nbsp;<I>actionsetname</I><BR>&nbsp;&nbsp;<B>)</B><BR><B>script</B><BR><B>End</B> <B>Sub</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><BR>&lt;<B>script</B> <B>language=&quot;javascript&quot;</B> <B>for=&quot;object&quot;</B> <B>event=&quot;onplay</B><B>(</B><BR>&nbsp;&nbsp;<I>actionsetname</I><BR>&nbsp;&nbsp;<B>)</B> <B>&quot;&gt;</B><BR>&lt;<B>!--</B><BR><B>script</B><BR>&nbsp;&nbsp;//-->&lt;<B>script&gt;</B><BR><H5>Parameters</H5>
<DL><DT><I>object</I>
 </DT><DD>Name of the sequencer played.
</DD><DT><I>actionsetname</I>
 </DT><DD>Name of the action set played by the sequencer.
</DD></DL>
<H5>Remarks</H5>
<P>The following example tests the actionsetname parameter passed (a variable set to the name of the action set last played) and conditionally executes a script based on which action set has been played.


<PRE><FONT FACE="Courier" SIZE="2">
Sub Sequencername_onplay(actionsetname)
&#009;If actionsetname = "ActionSet1" then
&#009;&#009;Call Seq("ActionSet2").stop
&#009;Else
&#009;&#009;Call Seq("ActionSet1").stop
&#009;Endif
End Sub
</FONT></PRE>
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020b00">OnSeek Event</A></H3>
<A HREF="DA_E0019.htm" TARGET="TEXT">Sequencer Control</A>
<P>Called after the <A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020600" TARGET="TEXT">Seek</A> method is invoked against a sequencer has completed changing the playback position. At this point, the <I>script</I> is executed.

<P><BR><B>VBScript</B> <B>Syntax</B><BR><B>Sub</B> <B>object_</B> <B>onseek</B> <B>(</B><BR>&nbsp;&nbsp;<I>actionsetname</I><B>,</B><BR>&nbsp;&nbsp;<I>newtime</I><BR>&nbsp;&nbsp;<B>)</B><BR><B>script</B><BR><B>End</B> <B>Sub</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><BR>&lt;<B>script</B> <B>language=&quot;javascript&quot;</B> <B>for=&quot;object&quot;</B> <B>event=&quot;onseek</B><B>(</B><BR>&nbsp;&nbsp;<I>actionsetname</I><B>,</B><BR>&nbsp;&nbsp;<I>newtime</I><BR>&nbsp;&nbsp;<B>)</B> <B>&quot;&gt;</B><BR>&lt;<B>!--</B><BR><B>script</B><BR>&nbsp;&nbsp;//-->&lt;<B>script&gt;</B><BR><H5>Parameters</H5>
<DL><DT><I>object</I>
 </DT><DD>Name of the sequencer.
</DD><DT><I>actionsetname</I>
 </DT><DD>Specific action set from which the <A CLASS=tctop HREF="DA_E0019.htm#daseq_0001040103020600" TARGET="TEXT">Seek</A> method was invoked.
</DD><DT><I>newtime</I>
 </DT><DD>New playback time to which the sequencer has been moved.
</DD></DL>
<H5>Remarks</H5>
<P>This event can be useful in determining where the sequencer playback has been moved and set up conditional action based on the sequencer's new position. 


However, you can't have an <B>OnSeek</B> event call a seek method


 that seeks to a position within the same action set from which the <B>OnSeek</B> event originated.
<PRE><FONT FACE="Courier" SIZE="2">
Sub Sequencername_onseek(actionsetname, time)
&#009;If actionsetname = "ActionSet1" then
&#009;&#009;If time = 10.000 then
&#009;&#009;&#009;Call Seq("ActionSet2").Play
&#009;&#009;Else
&#009;&#009;&#009;Call Seq("ActionSet1").Play
&#009;&#009;EndIf
&#009;EndIf
End Sub
</FONT></PRE>
<H3><HR COLOR=#0000FF><A NAME="daseq_0001040103020c00">OnStop Event</A></H3>
<A HREF="DA_E0019.htm" TARGET="TEXT">Sequencer Control</A>
<P>Called when the sequencer is stopped.


 At this point, the <I>script</I> is executed.
<P><BR><B>VBScript</B> <B>Syntax</B><BR><B>Sub</B> <B>SequencerName_onstop</B><B>(</B><BR>&nbsp;&nbsp;<I>actionsetname</I><BR>&nbsp;&nbsp;<B>)</B><BR><B>script</B><BR><B>End</B> <B>Sub</B><BR><P><BR><B>JScript</B> <B>Syntax</B><BR><BR>&lt;<B>script</B> <B>language=&quot;javascript&quot;</B> <B>for=&quot;object&quot;</B> <B>event=&quot;onstop</B><B>(</B><BR>&nbsp;&nbsp;<I>actionsetname</I><BR>&nbsp;&nbsp;<B>)</B> <B>&quot;&gt;</B><BR>&lt;<B>!--</B><BR><B>script</B><BR>&nbsp;&nbsp;//-->&lt;<B>script&gt;</B><BR><H5>Parameters</H5>
<DL><DT><I>SequencerName</I>
 </DT><DD>Name of the stopped sequencer.
</DD><DT><I>actionsetname</I>
 </DT><DD>Name of the action set stopped by the sequencer.
</DD></DL>
<H5>Remarks</H5>
<P>The following example tests the actionsetname parameter passed (a variable set to the name of the action set last stopped) and conditionally executes a script based on which action set has been played.


<PRE><FONT FACE="Courier" SIZE="2">
Sub Sequencername_onstop(actionsetname)
&#009;If actionsetname = "ActionSet1" then
&#009;&#009;Call Seq("ActionSet2").play
&#009;Else
&#009;&#009;Call Seq("ActionSet1").play
&#009;Endif
End Sub
</FONT></PRE>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
