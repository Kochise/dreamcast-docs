<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Using the ActiveMovie Control in HTML Pages</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0010.htm','/dssd0000.htm','/dssd0009.htm','/index.htm','/dssd0012.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="amocx_0001020102000000">Using the ActiveMovie Control in HTML Pages</A></H2>
<BR CLEAR=ALL>
<P>Files on a Web page are referenced using URL names and various protocols, such as HTTP, file, FTP, or Gopher. These names can be either explicit or relative.

<P>Following are two examples of explicit references. The first example uses the HTTP protocol to access the file. The second uses a network path and file name.

<P>"http://directshow/samples/web/RoadRun.avi"

<P>"file://directshow/samples/web/RoadRun.avi"

<P>Here is an example of a relative reference:

<PRE><FONT FACE="Courier" SIZE="2">"/samples/web/RoadRun.avi"</FONT></PRE>
<P>In the examples in this article, you can assume that either relative or explicit file names will work and any protocol for accessing these file names will also work.

<P><B>Contents of this article:</B>
<UL><LI><A HREF="dssd0011.htm#amocx_0001020102010000" TARGET="TEXT">Invoking Playback on HTML Pages</A>
<LI><A HREF="dssd0011.htm#amocx_0001020102020000" TARGET="TEXT">Using the OBJECT Tag</A>
<LI><A HREF="dssd0011.htm#amocx_0001020102030000" TARGET="TEXT">Using the OBJECT Tag with the CODEBASE Attribute</A>
<LI><A HREF="dssd0011.htm#amocx_0001020102040000" TARGET="TEXT">Using the EMBED Tag</A>
<LI><A HREF="dssd0011.htm#amocx_0001020102050000" TARGET="TEXT">Using the IMG tag with the DYNSRC= Attribute</A>
<LI><A HREF="dssd0011.htm#amocx_0001020102060000" TARGET="TEXT">Using the A Tag with the HREF Attribute</A>
<LI><A HREF="dssd0011.htm#amocx_0001020102070000" TARGET="TEXT">How Progressive Downloading Works</A>
<LI><A HREF="dssd0011.htm#amocx_0001020102080000" TARGET="TEXT">Setting ActiveMovie Control Properties on a Web Page</A>

</UL>
<A NAME="amocx_0001020102010000"></A><P><B>Invoking Playback on HTML Pages</B>
<P>You can play files in one of two ways: either embedded in a Web page, or externally in a window displayed outside or on top of the page. There are four ways of playing back media using HTML tags. Three of these result in embedded playback:
<UL><LI>OBJECT
<LI>EMBED
<LI>IMG DYNSRC=
</UL>
<P>The fourth means of implementing playback results in an external window:
<UL><LI>A HREF
</UL>
<P>Although not restricted to playback, you can use an attribute of the OBJECT tag to automatically download a file that contains required components for playback. 
<UL><LI>OBJECT CODEBASE
</UL>
<P>The following examples show how you use these tags to reference the file, but do not show all possible properties and attributes (width, height, color, and so on) that could be specified as well. See <A HREF="dssd0011.htm#amocx_0001020102080000" TARGET="TEXT">Setting ActiveMovie Control Properties on a Web Page</A> for more information.


<A NAME="amocx_0001020102020000"></A><P><B>Using the OBJECT Tag</B>
<P>When you use the OBJECT tag, you must explicitly specify the class identifier (CLSID) for the playback control, as shown in the following example.

<PRE><FONT FACE="Courier" SIZE="2">&lt;OBJECT CLASSID="CLSID:05589FA1-C356-11CE-BF01-00AA0055595A"&gt;
&lt;PARAM NAME="FileName" VALUE="//directshow/samples/web/RoadRun.avi"&gt;
&lt;/OBJECT&gt;
</FONT></PRE>
<P>The preceding CLSID is that of the ActiveMovie Control. The application loads the control and passes it the file name. The control parses the file name and downloads and plays the file. If the protocol is "file," the control instantiates the <A HREF="dssd0314.htm#filteref_0001070114000000" TARGET="TEXT">File Source (async)</A> filter to play back the file. If the protocol is "http," the control instantiates the <A HREF="dssd0315.htm#filteref_0001070115000000" TARGET="TEXT">File Source (URL)</A> filter instead. See the DirectShow SDK documentation for more information on these filters.

<P>Using this tag, you can play back certain media types using "progressive downloading," which allows the user to play back the downloaded portion of the file as the data is downloading. See <A HREF="dssd0011.htm#amocx_0001020102070000" TARGET="TEXT">How Progressive Downloading Works</A> for more information.

<P>Using this tag along with the CODEBASE attribute, you can download components required for playback. See <A HREF="dssd0011.htm#amocx_0001020102030000" TARGET="TEXT">Using the OBJECT Tag with the CODEBASE Attribute</A> for more information.


<A NAME="amocx_0001020102030000"></A><P><B>Using the OBJECT Tag with the CODEBASE Attribute</B>
<P>As the author of a Web page, you might find that using components such as specialized DirectShow filters can enhance playback of your media files on the user's machine. However, if the necessary components aren't already installed on the user's computer, you need a method to install those components. Internet Explorer supports using the CODEBASE attribute of the OBJECT tag for automatic file download, and cabinet (.cab) files for automatic installation. See 
<A HREF="http://www.microsoft.com/workshop/prog/cab/default.htm" TARGET="_top">http://www.microsoft.com/workshop/prog/cab/default.htm</A> for information about the Cabinet SDK and .cab files.

<P>The CODEBASE attribute works in conjunction with the OBJECT tag. See <A HREF="dssd0011.htm#amocx_0001020102020000" TARGET="TEXT">Using the OBJECT Tag</A> for another example that uses the OBJECT tag.

<P>An example of filter download using the CODEBASE attribute and a .cab file follows:

<PRE><FONT FACE="Courier" SIZE="2">
&lt;OBJECT ID=GargleFilter1
CLASSID="CLSID:d616f350-d622-11ce-aac5-0020af0b99a3"
CODEBASE="http://directshow/samples/gargle.cab"&gt;
&lt;/OBJECT&gt;
</FONT></PRE>
<P>The preceding class identifier (CLSID) is the ID of the Gargle filter, which applies a "gargle" sound effect to a sound file. Internet Explorer checks the target computer's registry for the specified CLSID. If the specified CLSID is not present (indicating the filter is not installed on the machine), the browser attempts to find the file (Gargle.cab) at the site specified by the CODEBASE attribute and download it. Once downloaded, the .cab file provides the information to automatically install the filter.

<P><B>Note:</B>  The .cab file must have been properly constructed for automatic installation to work. The .cab must include the filter (Gargle.ax in this case) and an .inf file that contains installation information. The .inf file should handle copying each filter to a specific directory (such as the Windows&#174; System directory) on the user's computer and properly registering each filter. See the Platform SDK for information about .inf files.<A NAME="amocx_0001020102040000"></A><P><B>Using the EMBED Tag</B>
<P>Netscape introduced this tag for embedding source. The following example uses this tag.

<PRE><FONT FACE="Courier" SIZE="2">&lt;EMBED autostart="FALSE" loop="FALSE" SRC="http://directshow/samples/web/RoadRun.avi"&gt;
</FONT></PRE>
<P>This tag works identically to the OBJECT tag, except that you don't need to specify the CLSID. Internally, DirectShow examines the HKCR/MIME/Database/Content Type registry entries, retrieves the appropriate CLSID (DirectShow automatically registers all compatible data types at install time), and launches the control with that media type.


<A NAME="amocx_0001020102050000"></A><P><B>Using the IMG tag with the DYNSRC= Attribute</B>
<P>Internet Explorer can use


 the DYNSRC= attribute to play back audio-video interleaved (AVI) files. You can use this playback mechanism, but it is preferable to use the OBJECT tag. The following example demonstrates this HTML tag.

<PRE><FONT FACE="Courier" SIZE="2">&lt;IMG start=1 loop=0 DYNSRC="http://directshow/samples/web/RoadRun.avi"&gt;
</FONT></PRE>
<A NAME="amocx_0001020102060000"></A><P><B>Using the A Tag with the HREF Attribute</B>
<P>To play back a movie in an external movie, use the A tag with the HREF attribute. An example of this follows:

<PRE><FONT FACE="Courier" SIZE="2">&lt;A HREF="http://directshow/samples/web/dwad.cinepack.avi"&gt;AVI_CINEPACK&lt;/A&gt;
</FONT></PRE>
<P>The parsing steps that Internet Explorer 3.0 (or later) goes through are similar to the "EMBED SRC tag" case, in that it gets the file extension, maps it to a content type and looks in the HKCR/MIME/Database/Content Type area of the registry to get a CLSID to invoke. However, in this case the control plays in an external window. The ActiveMovie Control is in control of downloading the file.



<A NAME="amocx_0001020102070000"></A><P><B>How Progressive Downloading Works</B>
<P>The following series of steps describes what happens during progressive downloading.

<OL><LI>As soon as possible after activation, the ActiveMovie Control displays the first frame in the file (for movies). The filter graph remains in a paused state.
<LI>The control does not start to play until it determines that it has enough data to play uninterrupted while the remaining amount downloads. At this time, playback starts and downloading will continue.
<LI>The user can click the Play button during this time. In this case, the control will play until the play cursor reaches the end of the current amount downloaded and will automatically transition from the running state to the paused state.
<LI>The download of the file will not stop if the user clicks Stop. The user can stop the download by closing the control.
<LI>For most AVI or QuickTime files, you can't start playback until DirectShow has read the entire file (because the indexes are at the end of the file). However, the download bar is displayed to show how much of the file has been downloaded. The Play control button remains unavailable until the control downloads the file completely.
</OL>
<A NAME="amocx_0001020102080000"></A><P><B>Setting ActiveMovie Control Properties on a Web Page</B>
<P>You can set any ActiveMovie Control property by using the PARAM tag inside an OBJECT container. For Boolean values, &#150;1 is TRUE and 0 is FALSE. All other values are set as they would be in the Microsoft&#174; Visual Basic&#174; design environment.

<P>The following example demonstrates playing a movie with most controls shown. If you have a video file and you want to try this, you can copy and paste this code onto your Web page and modify the parameters as you want. If you do this, be sure to change the movie's file name, perhaps using a relative path and file protocol (for example, PARAM NAME="FileName" VALUE="file://c:\mymovie.mpg") to play the movie from your hard drive.

<PRE><FONT FACE="Courier" SIZE="2">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;ActiveMovie Embedded MPG Object Test Page&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
Scene from Stargate (MPG File)

&lt;OBJECT ID="ActiveMovie1" WIDTH=357 HEIGHT=322
CLASSID="CLSID:05589FA1-C356-11CE-BF01-00AA0055595A"&gt;
&lt;PARAM NAME="Version" VALUE="1"&gt;
&lt;PARAM NAME="EnableContextMenu" VALUE="-1"&gt;
&lt;PARAM NAME="ShowDisplay" VALUE="-1"&gt;
&lt;PARAM NAME="ShowControls" VALUE="-1"&gt;
&lt;PARAM NAME="ShowPositionControls" VALUE="0"&gt;
&lt;PARAM NAME="ShowSelectionControls" VALUE="0"&gt;
&lt;PARAM NAME="EnablePositionControls" VALUE="-1"&gt;
&lt;PARAM NAME="EnableSelectionControls" VALUE="-1"&gt;
&lt;PARAM NAME="ShowTracker" VALUE="-1"&gt;
&lt;PARAM NAME="EnableTracker" VALUE="-1"&gt;
&lt;PARAM NAME="AllowHideDisplay" VALUE="-1"&gt;
&lt;PARAM NAME="AllowHideControls" VALUE="-1"&gt;
&lt;PARAM NAME="MovieWindowSize" VALUE="0"&gt;
&lt;PARAM NAME="FullScreenMode" VALUE="0"&gt;
&lt;PARAM NAME="MovieWindowWidth" VALUE="353"&gt;
&lt;PARAM NAME="MovieWindowHeight" VALUE="318"&gt;
&lt;PARAM NAME="AutoStart" VALUE="0"&gt;
&lt;PARAM NAME="AutoRewind" VALUE="-1"&gt;
&lt;PARAM NAME="PlayCount" VALUE="1"&gt;
&lt;PARAM NAME="SelectionStart" VALUE="0"&gt;
&lt;PARAM NAME="SelectionEnd" VALUE="48.5151388"&gt;
&lt;PARAM NAME="Appearance" VALUE="1"&gt;
&lt;PARAM NAME="BorderStyle" VALUE="1"&gt;
&lt;PARAM NAME="FileName" VALUE="http://DirectShow/samples/web/stargate1.mpg"&gt;
&lt;PARAM NAME="DisplayMode" VALUE="0"&gt;
&lt;PARAM NAME="AllowChangeDisplayMode" VALUE="-1"&gt;
&lt;PARAM NAME="DisplayForeColor" VALUE="16777215"&gt;
&lt;PARAM NAME="DisplayBackColor" VALUE="0"&gt;
&lt;/OBJECT&gt;
&lt;/BODY&gt;
</FONT></PRE>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
