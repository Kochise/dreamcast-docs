<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>ModelMakerApplet Class</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/DA_E0144.htm','/DA_E0000.htm','/DA_E0116.htm','/index.htm','/DA_E0146.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="dxmref_000107011d000000">ModelMakerApplet Class</A></H2>
<BR CLEAR=ALL>
<PRE><FONT FACE="Courier" SIZE="2">public abstract ModelMakerApplet extends java.lang.Object {

    // Constructor
    public ModelMakerApplet();

    // Methods
    public ImageBvr createBackgroundImage();
    public IDABehavior grabBackgroundImageComPtr();
    public IDABehavior grabImageComPtr();
    public IDABehavior grabSoundComPtr();
    public IDAView grabViewComPtr();
    public ErrorAndWarningReceiver registerErrorAndWarningReceiver(ErrorAndWarningReceiver w);
    public synchronized void setModel(Model model);
}
</FONT></PRE>
<P>The <B>ModelMakerApplet</B> class is used for constructing models in Java and using them in windowless controls. It is similar to <A HREF="DA_E0130.htm" TARGET="TEXT">DXMApplet</A> except that it exposes some COM interfaces and doesn't do any ticking (this is performed by the DirectAnimation control called DAViewer). Here is the basic syntax for using <B>ModelMakerApplet</B>:

<PRE><FONT FACE="Courier" SIZE="2">
public class MyTest extends ModelMakerApplet{
    public MyTest() { 
     setModel(new testModel());
   }
}
</FONT></PRE>
<P>The <A HREF="DA_E0145.htm#dxmref_000107011d020200" TARGET="TEXT">grabBackgroundImageComPtr</A>, <A HREF="DA_E0145.htm#dxmref_000107011d020300" TARGET="TEXT">grabImageComPtr</A>, <A HREF="DA_E0145.htm#dxmref_000107011d020400" TARGET="TEXT">grabSoundComPtr</A>, and <A HREF="DA_E0145.htm#dxmref_000107011d020500" TARGET="TEXT">grabViewComPtr</A> methods are used on the HTML page, and can be called either from VBscript or Jscript. Here is an example of an HTML page that calls these methods, using VBScript:

<PRE><FONT FACE="Courier" SIZE="2">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;myTest Windowless Control&lt;/TITLE&gt;
&lt;/HEAD&gt;

&lt;body&gt;

&lt;DIV ID=LAYOUT STYLE="position:absolute; left:0; top:0; width:600; height:400"&gt;

&lt;DIV ID=text STYLE="position:absolute; left:0; top:0; width:450; height:280"&gt;
&lt;FONT SIZE=4 FACE="Verdana,Tahoma,Arial"&gt;       
This is standard HTML arranged using DIV tags and atop it we're going
to place our DirectX Animation windowless control.  
&lt;/FONT&gt;&lt;/DIV&gt;
&lt;/DIV&gt;


&lt;DIV ID=controlDiv&gt;
&lt;OBJECT ID="DAViewer"
        STYLE="position:absolute; left:50; top:10;width:200;height:300" 
        CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D"&gt;
&lt;/OBJECT&gt;
&lt;/DIV&gt;

&lt;/DIV&gt;

' The width and height parameters are placeholders. They need to be there to specify the applet and must be set to 1.

&lt;applet code=myTest.class codebase=. width=1 height=1 id=javaApp&gt;
&lt;/applet&gt;

&lt;script language="VBScript"&gt;
   sub window_onLoad
       set a = document.javaApp

       ' Get model components out of the Java applet and give it to the
       ' control. 
       DAViewer.View            = a.grabViewComPtr
       DAViewer.Image           = a.grabImageComPtr
       DAViewer.BackgroundImage = a.grabBackgroundImageComPtr
       DAViewer.Sound           = a.grabSoundComPtr

       ' Start the control viewing
       DAViewer.Start 

   end sub
&lt;/script&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;

</FONT></PRE>
<UL><LI><A CLASS=tctop HREF="DA_E0145.htm#dxmref_000107011d010000" TARGET="TEXT">Constructor</A>
<LI><A CLASS=tctop HREF="DA_E0145.htm#dxmref_000107011d020000" TARGET="TEXT">Methods</A>
</UL>
<H3><A NAME="dxmref_000107011d010000">Constructor</A></H3>
<P><A CLASS=tctop HREF="DA_E0145.htm#dxmref_000107011d010100" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">ModelMakerApplet();</A><BR>
<H4><HR COLOR=#0000FF><A NAME="dxmref_000107011d010100">ModelMakerApplet();</A></H4>
<A HREF="DA_E0145.htm" TARGET="TEXT">ModelMakerApplet Class</A>
<P>Creates an <A HREF="DA_E0145.htm" TARGET="TEXT">ModelMakerApplet</A> object.

<P><B>public</B> <B>ModelMakerApplet</B><B>(</B> <B>)</B><B>;</B><BR><H3><A NAME="dxmref_000107011d020000">Methods</A></H3>
<P><A CLASS=tctop HREF="DA_E0145.htm#dxmref_000107011d020100" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">createBackgroundImage</A><BR>
<P><A CLASS=tctop HREF="DA_E0145.htm#dxmref_000107011d020200" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">grabBackgroundImageComPtr</A><BR>
<P><A CLASS=tctop HREF="DA_E0145.htm#dxmref_000107011d020300" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">grabImageComPtr</A><BR>
<P><A CLASS=tctop HREF="DA_E0145.htm#dxmref_000107011d020400" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">grabSoundComPtr</A><BR>
<P><A CLASS=tctop HREF="DA_E0145.htm#dxmref_000107011d020500" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">grabViewComPtr()</A><BR>
<P><A CLASS=tctop HREF="DA_E0145.htm#dxmref_000107011d020600" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">registerErrorAndWarningReceiver</A><BR>
<P><A CLASS=tctop HREF="DA_E0145.htm#dxmref_000107011d020700" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">setModel</A><BR>
<H4><HR COLOR=#0000FF><A NAME="dxmref_000107011d020100">createBackgroundImage</A></H4>
<A HREF="DA_E0145.htm" TARGET="TEXT">ModelMakerApplet Class</A>
<P>This method is used so that models constructed in Java, intended for windowless controls, will have a background image if they appear in a browser that does not support this feature. The model will then be displayed in its own window, as if it were in a standard DirectAnimation applet. Just as these models need a background image to be explicitly inserted, so do windowless applets if they are to degrade gracefully to a windowed display. 

<P>This method should be called within <A HREF="DA_E0145.htm" TARGET="TEXT">ModelMakerApplet</A> and not during the <A HREF="DA_E0144.htm#dxmref_000107011c020700" TARGET="TEXT">createModel</A> implementation. Here is an example:

<PRE><FONT FACE="Courier" SIZE="2">
public class myTest extends ModelMakerApplet {

  public ImageBvr createBackgroundImage() {
      return Statics.solidColorImage(Statics.black);
  }
      setModel(new testModel());
}
</FONT></PRE>
<P><B>public</B> <B>ImageBvr</B> <B>createBackgroundImage</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0139.htm" TARGET="TEXT">ImageBvr</A> object.


<H4><HR COLOR=#0000FF><A NAME="dxmref_000107011d020200">grabBackgroundImageComPtr</A></H4>
<A HREF="DA_E0145.htm" TARGET="TEXT">ModelMakerApplet Class</A>
<P>Retrieves the background image component of the model. This method is called from a script on the HTML page.

<P><B>public</B> <B>IDABehavior</B> <B>grabBackgroundImageComPtr</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the COM pointer to the IDABehavior interface (rather than an <A HREF="DA_E0139.htm" TARGET="TEXT">ImageBvr</A>.)


<H4><HR COLOR=#0000FF><A NAME="dxmref_000107011d020300">grabImageComPtr</A></H4>
<A HREF="DA_E0145.htm" TARGET="TEXT">ModelMakerApplet Class</A>
<P>Retrieves the image component of the model. This method is called from a script on the HTML page.

<P><B>public</B> <B>IDABehavior</B> <B>grabImageComPtr</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the COM pointer to the IDABehavior interface (rather than an <A HREF="DA_E0139.htm" TARGET="TEXT">ImageBvr</A>.)


<H4><HR COLOR=#0000FF><A NAME="dxmref_000107011d020400">grabSoundComPtr</A></H4>
<A HREF="DA_E0145.htm" TARGET="TEXT">ModelMakerApplet Class</A>
<P>Retrieves the sound component of the model. This method is called from a script on the HTML page.

<P><B>public</B> <B>IDABehavior</B> <B>grabSoundComPtr</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the COM pointer to the IDABehavior interface (rather than a <A HREF="DA_E0156.htm" TARGET="TEXT">SoundBvr</A>.)


<H4><HR COLOR=#0000FF><A NAME="dxmref_000107011d020500">grabViewComPtr()</A></H4>
<A HREF="DA_E0145.htm" TARGET="TEXT">ModelMakerApplet Class</A>
<P>Returns the viewer component of the model. This method is called from a script on the HTML page.

<P><B>public</B> <B>IDAView</B> <B>grabViewComPtr</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the COM pointer to the IDABehavior interface (rather than a <A HREF="DA_E0211.htm" TARGET="TEXT">Viewer</A>.)


<H4><HR COLOR=#0000FF><A NAME="dxmref_000107011d020600">registerErrorAndWarningReceiver</A></H4>
<A HREF="DA_E0145.htm" TARGET="TEXT">ModelMakerApplet Class</A>
<P>Allows the application to register an object that will have its methods invoked upon asynchronous errors encountered when DirectAnimation media is controlling the frame loop or when recoverable errors occur when sampling and displaying the model.

<P><B>public</B> <B>ErrorAndWarningReceiver</B> <B>registerErrorAndWarningReceiver</B><B>(</B><BR>&nbsp;&nbsp;<B>ErrorAndWarningReceiver</B> <I>w</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>w</I>
 </DT><DD>The <A HREF="DA_E0135.htm" TARGET="TEXT">ErrorAndWarningReceiver</A> object to be registered.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0135.htm" TARGET="TEXT">ErrorAndWarningReceiver</A> object.


<H4><HR COLOR=#0000FF><A NAME="dxmref_000107011d020700">setModel</A></H4>
<A HREF="DA_E0145.htm" TARGET="TEXT">ModelMakerApplet Class</A>
<P>Sets the model that will be used.

<P><B>public</B> <B>synchronized</B> <B>void</B> <B>setModel</B><B>(</B><BR>&nbsp;&nbsp;<B>Model</B> <I>model</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>model</I>
 </DT><DD>The model to be set.
</DD></DL>
<H5>Remarks</H5>
<P>This method must be called before the model is started. Calling it after the model has started causes an exception.

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
