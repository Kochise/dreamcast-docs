<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IConfigInterleaving Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0120.htm','/dssd0000.htm','/dssd0088.htm','/index.htm','/dssd0122.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_0001060121000000">IConfigInterleaving Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IConfigInterleaving</B> interface controls how files are written out to disk and sets interleaving


 configuration information such as frequency and <A HREF="dssd0404.htm#gloss_00010b010f000006" TARGET="TEXT">preroll</A> parameters.



<P>This interface uses the <A HREF="dssd0288.htm#dtypes_0001060601001900" TARGET="TEXT">InterleavingMode</A> enumerated data type, which specifies how audio samples and video frames will be saved on a disk.



 Capture interleaving settings can range from INTERLEAVE_NONE to INTERLEAVE_FULL, depending on whether you will author



 immediately or at a later point in time.

<P>DirectShow currently implements this interface on the <A HREF="dssd0303.htm#filteref_0001070109000000" TARGET="TEXT">AVI multiplexer filter</A>;



 however, you can implement it



 to set interleaving preferences on other file formats.

<A NAME="If_0001060121010000"></A><P><B>When to Implement
</B>
<P>DirectShow implements this interface and makes its functionality available to anyone through the property page of an AVI multiplexer filter. However, you can implement this interface yourself when you want to be able to write out other file formats.




<A NAME="If_0001060121020000"></A><P><B>When to Use
</B>
<P>Video-authoring applications that handle capturing should use this interface when they need to control how audio samples and video frames will be saved on a disk. Applications also use this interface when they need to set interleaving configuration information such as frequency and <A HREF="dssd0404.htm#gloss_00010b010f000006" TARGET="TEXT">preroll</A> parameters. (see Amcap.exe as a sample implemention of this interface).




<A NAME="If_0001060121030000"></A><P><B>Methods in Vtable Order

</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IConfigInterleaving methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0121.htm#If_0001060121030100" TARGET="TEXT">put_Mode</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets how audio samples and video frames will be saved on disk



 by specifying quality of interleaving.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0121.htm#If_0001060121030200" TARGET="TEXT">get_Mode</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the interleaving quality setting.



 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0121.htm#If_0001060121030300" TARGET="TEXT">put_Interleaving</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the audio preroll time and the frequency of the interleaving.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0121.htm#If_0001060121030400" TARGET="TEXT">get_Interleaving</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the audio preroll time and the frequency of the interleaving.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="If_0001060121030100">IConfigInterleaving::put_Mode</A></H3>
<A HREF="dssd0121.htm" TARGET="TEXT">IConfigInterleaving Interface</A>
<P>Sets how audio samples and video frames are to be written to disk, by specifying quality of interleaving.
<P><B>HRESULT</B> <B>put_</B> <B>Mode</B><B>(</B><BR>&nbsp;&nbsp;<B>InterleavingMode</B> <I>mode</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>mode</I>
 </DT><DD>[in] Interleaving quality setting specified in the <A HREF="dssd0288.htm#dtypes_0001060601001900" TARGET="TEXT">InterleavingMode</A> enumerated data type.



</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>Applications that require



 full interleaving authoring quality



 should specify INTERLEAVE_FULL, INTERLEAVE_CAPTURE, and INTERLEAVE_NONE settings when you will author



 at a later time.

<H5>See Also</H5>
<P><A HREF="dssd0121.htm#If_0001060121030200" TARGET="TEXT">IConfigInterleaving::get_Mode</A>


 
<H3><HR COLOR=#0000FF><A NAME="If_0001060121030200">IConfigInterleaving::get_Mode</A></H3>
<A HREF="dssd0121.htm" TARGET="TEXT">IConfigInterleaving Interface</A>
<P>Retrieves the interleaving quality setting.
<P><B>HRESULT</B> <B>get_</B> <B>Mode</B><B>(</B><BR>&nbsp;&nbsp;<B>InterleavingMode</B> <I>*pMode</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>mode</I>
 </DT><DD>[out] Interleaving quality setting specified in the <A HREF="dssd0288.htm#dtypes_0001060601001900" TARGET="TEXT">InterleavingMode</A> enumerated data type.


</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>The interleaving mode is specified in the <A HREF="dssd0288.htm#dtypes_0001060601001900" TARGET="TEXT">InterleavingMode</A> enumerated data type and is set in the <A HREF="dssd0121.htm#If_0001060121030100" TARGET="TEXT">IConfigInterleaving::put_Mode</A> method.

<H5>See Also</H5>
<P><A HREF="dssd0121.htm#If_0001060121030100" TARGET="TEXT">IConfigInterleaving::put_Mode</A> 
<H3><HR COLOR=#0000FF><A NAME="If_0001060121030300">IConfigInterleaving::put_Interleaving</A></H3>
<A HREF="dssd0121.htm" TARGET="TEXT">IConfigInterleaving Interface</A>
<P>Sets the audio preroll time and the frequency of the interleaving.
<P><B>HRESULT</B> <B>put_</B> <B>Interleaving</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>REFERENCE_TIME</B> <I>*prtInterleave</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>REFERENCE_TIME</B> <I>*prtPreroll</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>prtInterleave</I>
 </DT><DD>[in] Frequency of the streams in the file, in 100-nanosecond units.
</DD><DT><I>prtPreroll</I>
 </DT><DD>[in] Audio preroll, in 100-nanosecond units.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>An audio preroll of 750 milliseconds is recommended when authoring a file for distribution. 
<P>The default value for <I>prtInterleave</I> is 1000 milliseconds, however you can adjust this.






 The smaller the number, the larger the file overhead.


<H5>See Also</H5>
<P><A HREF="dssd0121.htm#If_0001060121030400" TARGET="TEXT">IConfigInterleaving::get_Interleaving</A>
 

<H3><HR COLOR=#0000FF><A NAME="If_0001060121030400">IConfigInterleaving::get_Interleaving</A></H3>
<A HREF="dssd0121.htm" TARGET="TEXT">IConfigInterleaving Interface</A>
<P>Retrieves the audio preroll time and the frequency of the interleaving.
<P><B>HRESULT</B> <B>get_</B> <B>Interleaving</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>*prtInterleave</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>*prtPreroll</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>prtInterleave</I>
 </DT><DD>[out] Frequency of the streams in the file, in 100-nanosecond units.



</DD><DT><I>prtPreroll</I>
 </DT><DD>[out] Audio preroll, in 100-nanosecond units.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>See Also</H5>
<P><A HREF="dssd0121.htm#If_0001060121030300" TARGET="TEXT">IConfigInterleaving::put_Interleaving</A>
 
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
