<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IMediaSample2 Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0156.htm','/dssd0000.htm','/dssd0088.htm','/index.htm','/dssd0158.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_0001060145000000">IMediaSample2 Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IMediaSample2</B> interface is derived from the <A HREF="dssd0156.htm" TARGET="TEXT">IMediaSample</A> interface. It enables you to set and to retrieve sample properties.



<A NAME="If_0001060145010000"></A><P><B>When to Implement</B>
<P>Implement this interface if you implement an allocator that creates media samples. The <A HREF="dssd0228.htm#Lib_0001060230000000" TARGET="TEXT">CMediaSample</A> class in the Microsoft&#174; DirectShow&#153; class library implements this interface.

<A NAME="If_0001060145020000"></A><P><B>When to Use</B>
<P>Use this interface if you want to retrieve properties from a media sample that are available through the <A HREF="dssd0156.htm" TARGET="TEXT">IMediaSample</A> interfaces


 or if you want to retrieve multiple sample properties in one call.

<P>Not all media samples will support <A HREF="dssd0157.htm" TARGET="TEXT">IMediaSample2</A>, so use the <A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">IUnknown::QueryInterface</A> method to get a pointer to the sample's <B>IMediaSample2</B> interface and check for failure.

<P>If an allocator generates samples, then either all of the media samples must support <A HREF="dssd0157.htm" TARGET="TEXT">IMediaSample2</A> or none of them will.

<A NAME="If_0001060145030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IMediaSample methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030400" TARGET="TEXT">GetPointer</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a read/write pointer to this buffer's memory.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030500" TARGET="TEXT">GetSize</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the size, in bytes, of the buffer data area.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030600" TARGET="TEXT">GetTime</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the stream times at which this sample should begin and finish.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144031000" TARGET="TEXT">SetTime</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the stream times at which this sample should begin and finish.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030900" TARGET="TEXT">IsSyncPoint</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Determines if the beginning of a sample is a synchronization point.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030f00" TARGET="TEXT">SetSyncPoint</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the synchronization point.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030800" TARGET="TEXT">IsPreroll</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Indicates a preroll property. If TRUE, this sample is for preroll only and should not be displayed.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030e00" TARGET="TEXT">SetPreroll</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the preroll property. If TRUE, this sample is for preroll only and should not be displayed.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030100" TARGET="TEXT">GetActualDataLength</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the data length of the sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030a00" TARGET="TEXT">SetActualDataLength</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the data length of the sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030300" TARGET="TEXT">GetMediaType</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the media type of the sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030d00" TARGET="TEXT">SetMediaType</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the media type of the sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030700" TARGET="TEXT">IsDiscontinuity</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Indicates a discontinuity property. If S_OK is returned, sample is not contiguous with previous sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030b00" TARGET="TEXT">SetDiscontinuity</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the discontinuity property. Set to TRUE if sample is new after a seek or dropped sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030200" TARGET="TEXT">GetMediaTime</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the media time stamps for the sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0156.htm#If_0001060144030c00" TARGET="TEXT">SetMediaTime</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the media time stamps for the sample.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IMediaSample2 methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0157.htm#If_0001060145030100" TARGET="TEXT">GetProperties</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the properties of a media sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0157.htm#If_0001060145030200" TARGET="TEXT">SetProperties</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the properties of a media sample.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="If_0001060145030100">IMediaSample2::GetProperties</A></H3>
<A HREF="dssd0157.htm" TARGET="TEXT">IMediaSample2 Interface</A>
<P>Retrieves the properties of a media sample.

<P><B>HRESULT</B> <B>GetProperties</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>cbProperties</I><B>,</B><BR>&nbsp;&nbsp;<B>BYTE</B> <B>*</B> <I>pbProperties</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>cbProperties</I>
</DT><DD>[in] Length of property data to retrieve.


</DD><DT><I>pbProperties</I>
</DT><DD>[out, size_is(cbProperties)]


 Pointer to a generic data buffer. This value can be NULL if <I>cbProperties</I> is NULL. Data conforms to the format of the <A HREF="dssd0287.htm#structs_0001060501000400" TARGET="TEXT">AM_SAMPLE2_PROPERTIES</A> structure.


</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The default implementation returns S_OK.

<H5>Remarks</H5>
<P>You can use this method to return only some of the sample properties by setting <I>cbProperties</I> to be less than the size of the <A HREF="dssd0287.htm#structs_0001060501000400" TARGET="TEXT">AM_SAMPLE2_PROPERTIES</A> structure.

<P>For performance reasons, the pMediaType field


 returned in <A HREF="dssd0287.htm#structs_0001060501000400" TARGET="TEXT">AM_SAMPLE2_PROPERTIES</A> is merely a pointer to the data stored in the media sample. Therefore, the pointer will not necessarily be valid after the sample has been passed to another filter or after the <B>Receive</B> call to which it was passed has been completed. Therefore also


 the pointer does
not need to be freed


 as the pointer returned from the <A HREF="dssd0156.htm#If_0001060144030300" TARGET="TEXT">IMediaSample::GetMediaType</A> method does.
<H3><HR COLOR=#0000FF><A NAME="If_0001060145030200">IMediaSample2::SetProperties</A></H3>
<A HREF="dssd0157.htm" TARGET="TEXT">IMediaSample2 Interface</A>
<P>Sets the properties of a media sample

<P><B>HRESULT</B> <B>SetProperties</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>cbProperties</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>BYTE</B> <B>*</B> <I>pbProperties</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>cbProperties</I>
</DT><DD>[in] Length of property data to set.


</DD><DT><I>pbProperties</I>
</DT><DD>[in, size_is(cbProperties)]


 Pointer to properties to set. This value can be NULL if <I>cbProperties</I> is NULL. Data conforms to the format of the <A HREF="dssd0287.htm#structs_0001060501000400" TARGET="TEXT">AM_SAMPLE2_PROPERTIES</A> structure.


</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
