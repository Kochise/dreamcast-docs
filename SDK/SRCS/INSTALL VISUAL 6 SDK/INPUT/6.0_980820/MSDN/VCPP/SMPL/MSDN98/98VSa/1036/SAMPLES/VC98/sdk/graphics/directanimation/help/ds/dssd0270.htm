<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Property Page Helper Functions</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0269.htm','/dssd0000.htm','/dssd0256.htm','/index.htm','/dssd0271.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="fmutil_000106030e000000">Property Page Helper Functions</A></H2>
<BR CLEAR=ALL>
<P>The Videoctl.h header file in the DirectShow base classes provides functions to help with property page implementations.


<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Function </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0270.htm#fmutil_000106030e000100" TARGET="TEXT">GetDialogSize</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the size of a resource dialog box in screen pixels.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0270.htm#fmutil_000106030e000200" TARGET="TEXT">StringFromResource</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Loads a string from a resource file with the given resource identifier.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0270.htm#fmutil_000106030e000300" TARGET="TEXT">WideStringFromResource</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Loads a Unicode string from a resource file with the given resource identifier.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="fmutil_000106030e000100">GetDialogSize</A></H3>
<P>Retrieves the size of a resource dialog box.
<P><B>BOOL</B> <B>WINAPI</B> <B>GetDialogSize</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>iResourceID</I><B>,</B><BR>&nbsp;&nbsp;<B>DLGPROC</B> <I>pDlgProc</I><B>,</B><BR>&nbsp;&nbsp;<B>LPARAM</B> <I>lParam</I><B>,</B><BR>&nbsp;&nbsp;<B>SIZE</B> <I>*pResult</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>iResourceID</I>
 </DT><DD>Dialog box resource identifier.
</DD><DT><I>pDlgProc</I>
 </DT><DD>Pointer to the dialog box procedure.
</DD><DT><I>lParam</I>
 </DT><DD>Any user data wanted in <I>pDlgProc</I>.
</DD><DT><I>pResult</I>
 </DT><DD>Size of the dialog box, in screen pixels.
</DD></DL>
<H5>Return Values</H5>
<P>Returns TRUE if the dialog box resource was found, or FALSE otherwise.

<H5>Remarks</H5>
<P>Property pages can use this function to return the actual display size they require. Most property pages are dialog boxes and, as such, have dialog box templates stored in resource files. Templates use dialog box units that do not map directly onto screen pixels. When a property page has its <A HREF="dssd0201.htm#Lib_0001060215050500" TARGET="TEXT">GetPageInfo</A> function called, it must return the actual display size in pixels. This method is passed the resource ID for the dialog box and will return its size in pixels.

<P>To make the calculation, the function creates an instance of the dialog box. To avoid the dialog box appearing on the screen temporarily, the dialog box's template in the resource file should not have a WS_VISIBLE property.
<H3><HR COLOR=#0000FF><A NAME="fmutil_000106030e000200">StringFromResource</A></H3>
<P>Loads a string from a resource file with the given resource identifier.
<P><B>TCHAR</B> <B>*</B> <B>WINAPI</B> <B>StringFromResource</B><B>(</B><BR>&nbsp;&nbsp;<B>TCHAR</B> <I>*pBuffer</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>iResourceID</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pBuffer</I>
 </DT><DD>String corresponding to <I>iResourceID</I>.
</DD><DT><I>iResourceID</I>
 </DT><DD>Resource identifier of the string to retrieve.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the same string as <I>pBuffer</I>. If the function is not successful, returns a null string.

<H5>Remarks</H5>
<P>The <I>pBuffer</I> buffer must be at least STR_MAX_LENGTH bytes.
<H3><HR COLOR=#0000FF><A NAME="fmutil_000106030e000300">WideStringFromResource</A></H3>
<P>Loads a Unicode string from a resource file with the given resource identifier.
<P><B>WCHAR</B> <B>*</B> <B>WINAPI</B> <B>WideStringFromResource</B><B>(</B><BR>&nbsp;&nbsp;<B>WCHAR</B> <I>*pBuffer</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>iResourceID</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pBuffer</I>
 </DT><DD>String corresponding to <I>iResourceID</I>.
</DD><DT><I>iResourceID</I>
 </DT><DD>Resource identifier of the string to retrieve.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the same string as <I>pBuffer</I>. If the function is not successful, returns a null string.

<H5>Remarks</H5>
<P>Property pages are typically called through their OLE interfaces, which use Unicode strings regardless of how the binary is built. This function allows you to convert a resource string to a Unicode string. The function converts the resource to a Unicode string (if it is not already one) after loading it.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
