<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IResourceManager Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0172.htm','/dssd0000.htm','/dssd0088.htm','/index.htm','/dssd0174.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_0001060155000000">IResourceManager Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IResourceManager</B> interface implements a resource manager to
resolve contentions for named resources.

<A NAME="If_0001060155010000"></A><P><B>When to Implement</B>
<P>Implement this interface on any object that performs the services of a resource manager.
The filter graph manager acts as a resource manager for Microsoft&#174; DirectShow&#153;
and delegates to any existing system-wide resource manager. The filter graph manager implements
the methods on this interface.

<A NAME="If_0001060155020000"></A><P><B>When to Use</B>
<P>Use this interface if your object requires resources that other objects are likely to use. The wave renderer uses this interface to resolve contentions
for the wave-output device to enable sound to follow focus.

<P>An object can use the resource manager supporting this interface
to resolve possible contention between existing resources. This is carried out by registering
the resource with the interface and then requesting it from this interface
whenever needed.

<P>Use this interface if your object detects user focus
changes that might affect resource usage. Notifying the resource manager
of a change of focus will cause the resource manager to switch contended
resources to the objects that have the focus of the user.

<A NAME="If_0001060155030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IResourceManager methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0173.htm#If_0001060155030400" TARGET="TEXT">Register</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Registers a single named resource with the resource manager.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0173.htm#If_0001060155030500" TARGET="TEXT">RegisterGroup</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Registers a named resource group with the resource manager.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0173.htm#If_0001060155030700" TARGET="TEXT">RequestResource</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Requests the use of a given registered resource.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0173.htm#If_0001060155030200" TARGET="TEXT">NotifyAcquire</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Notifies the resource manager that an attempt to acquire a resource has completed.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0173.htm#If_0001060155030300" TARGET="TEXT">NotifyRelease</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Notifies the resource manager that a resource consumer has released a resource.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0173.htm#If_0001060155030100" TARGET="TEXT">CancelRequest</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Cancels the request for a resource.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0173.htm#If_0001060155030800" TARGET="TEXT">SetFocus</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Notifies the resource manager that a specified object has been given the focus of the user.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0173.htm#If_0001060155030600" TARGET="TEXT">ReleaseFocus</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the focus object to NULL in the resource manager if the object of the current
focus object is the one specified in this method.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="If_0001060155030100">IResourceManager::CancelRequest</A></H3>
<A HREF="dssd0173.htm" TARGET="TEXT">IResourceManager Interface</A>
<P>Cancels the request for a resource.

<P><B>HRESULT</B> <B>CancelRequest</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>idResource</I><B>,</B><BR>&nbsp;&nbsp;<B>IResourceConsumer*</B> <I>pConsumer</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>idResource </I>
</DT><DD>[in] Resource identifier of a pending request.
</DD><DT><I>pConsumer </I>
</DT><DD>[in] <A HREF="dssd0172.htm" TARGET="TEXT">IResourceConsumer</A> interface that made the request.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method should be called when the <A HREF="dssd0172.htm" TARGET="TEXT">IResourceConsumer</A> object that requested the
resource has not received it and no longer requires it. If it has already received the
resource, it should use the <A HREF="dssd0173.htm#If_0001060155030300" TARGET="TEXT">IResourceManager::NotifyRelease</A> method.
<H3><HR COLOR=#0000FF><A NAME="If_0001060155030200">IResourceManager::NotifyAcquire</A></H3>
<A HREF="dssd0173.htm" TARGET="TEXT">IResourceManager Interface</A>
<P>Notifies the resource manager that an attempt to acquire a resource has completed.

<P><B>HRESULT</B> <B>NotifyAcquire</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>idResource</I><B>,</B><BR>&nbsp;&nbsp;<B>IResourceConsumer*</B> <I>pConsumer</I><B>,</B><BR>&nbsp;&nbsp;<B>HRESULT</B> <I>hr</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>idResource</I>
</DT><DD>[in] Token for the registered resource.
</DD><DT><I>pConsumer</I>
</DT><DD>[in] <A HREF="dssd0172.htm" TARGET="TEXT">IResourceConsumer</A> interface of the object requesting the resource.
</DD><DT><I>hr</I>
</DT><DD>[in] Success of the acquisition; S_OK if the resource was acquired, or an error value if not.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>Use this method after an <A HREF="dssd0172.htm#If_0001060154030100" TARGET="TEXT">IResourceConsumer::AcquireResource</A>
method returns an S_FALSE value, indicating that the acquisition will be asynchronous
(that is, handled by a callback mechanism). If the <I>hr</I> parameter is S_OK, the resource
manager will assume that the resource is now held by the caller. If the <I>hr</I>
parameter is anything other than S_OK, the resource manager will assume that the
attempt to acquire the resource failed and will reassign the resource elsewhere.
<H3><HR COLOR=#0000FF><A NAME="If_0001060155030300">IResourceManager::NotifyRelease</A></H3>
<A HREF="dssd0173.htm" TARGET="TEXT">IResourceManager Interface</A>
<P>Notifies the resource manager that <A HREF="dssd0172.htm" TARGET="TEXT">IResourceConsumer</A> has released a resource.

<P><B>HRESULT</B> <B>NotifyRelease</B> <B>LONG</B> <I>idResource</I><B>,</B><BR><BR>&nbsp;&nbsp;<B>IResourceConsumer*</B> <I>pConsumer</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bStillWant</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>idResource</I>
</DT><DD>[in] Resource token.
</DD><DT><I>pConsumer</I>
</DT><DD>[in] Object releasing the resource.
</DD><DT><I>bStillWant</I>
</DT><DD>[in] Flag specifying whether the resource is still required or not.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>Use this method in response to an <A HREF="dssd0172.htm#If_0001060154030200" TARGET="TEXT">IResourceConsumer::ReleaseResource</A>
method, or when you have finished using the resource. The <I>bStillWant</I>
parameter should be set TRUE if you still want the resource when it is next available,
or FALSE if you no longer want the resource.
<H3><HR COLOR=#0000FF><A NAME="If_0001060155030400">IResourceManager::Register</A></H3>
<A HREF="dssd0173.htm" TARGET="TEXT">IResourceManager Interface</A>
<P>Registers a single named resource with the resource manager.

<P><B>HRESULT</B> <B>Register</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>cResource</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG*</B> <I>plToken</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pName </I>
</DT><DD>[in] Named resource.
</DD><DT><I>cResource</I>
</DT><DD>[in] Number of resources.
</DD><DT><I>plToken</I>
</DT><DD>[out] Returned token identifying the resource to be used in additional calls.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method registers a named resource, which can contain a number
of resources, and returns a token to be used when requesting this resource.
It is not an error if the resource is already registered; if the number in the <I>cResource</I>
parameter is less than what is already registered, resources will be deallocated to the new
count. To unregister the resource, pass a count of zero in <I>cResource</I>.
<H3><HR COLOR=#0000FF><A NAME="If_0001060155030500">IResourceManager::RegisterGroup</A></H3>
<A HREF="dssd0173.htm" TARGET="TEXT">IResourceManager Interface</A>
<P>Registers a named resource group with the resource manager.

<P><B>HRESULT</B> <B>RegisterGroup</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>cResource</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG*</B> <I>palTokens</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG*</B> <I>plToken</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pName</I>
</DT><DD>[in] Named resource group.
</DD><DT><I>cResource</I>
</DT><DD>[in] Number of resources in the group.
</DD><DT><I>palTokens</I>
</DT><DD>[in, size_is(cResource)] Array of resources in the group.
</DD><DT><I>plToken</I>
</DT><DD>[out] Returned group resource identifier.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H3><HR COLOR=#0000FF><A NAME="If_0001060155030600">IResourceManager::ReleaseFocus</A></H3>
<A HREF="dssd0173.htm" TARGET="TEXT">IResourceManager Interface</A>
<P>Sets the focus object to NULL in the resource manager if the current
focus object is the one specified in this method.

<P><B>HRESULT</B> <B>ReleaseFocus</B><B>(</B><BR>&nbsp;&nbsp;<B>IUnknown*</B> <I>pFocusObject</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pFocusObject</I>
</DT><DD>[in] Focus object.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>Use this method when the object of focus is about to be destroyed to ensure that
the focus is not still being referenced.
<H3><HR COLOR=#0000FF><A NAME="If_0001060155030700">IResourceManager::RequestResource</A></H3>
<A HREF="dssd0173.htm" TARGET="TEXT">IResourceManager Interface</A>
<P>Requests the use of a given registered resource.

<P><B>HRESULT</B> <B>RequestResource</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>idResource</I><B>,</B><BR>&nbsp;&nbsp;<B>IUnknown*</B> <I>pFocusObject</I><B>,</B><BR>&nbsp;&nbsp;<B>IResourceConsumer*</B> <I>pConsumer</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>idResource</I>
</DT><DD>[in] Resource token retrieved when the resource was registered.
</DD><DT><I>pFocusObject</I>
</DT><DD>[in] <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A> interface of a focus object associated with a request
(normally the filter's <B>IUnknown</B> interface).
</DD><DT><I>pConsumer</I>
</DT><DD>[in] <A HREF="dssd0172.htm" TARGET="TEXT">IResourceConsumer</A> interface on the object requesting the resource.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value. Returns S_OK if the requested resource is returned, or
S_FALSE if the resource is not available, in which case the resource manager
will call the requesting object back when the resource becomes available.
Any other return is an error.

<H5>Remarks</H5>
<P>When there is more than one request for the resource, the resource manager
will decide the priority by using the object of focus passed with each request and
comparing it to the object of focus passed in the most recent <A HREF="dssd0173.htm#If_0001060155030800" TARGET="TEXT">IResourceManager::SetFocus</A> method.

<P>Requests will be filled in the following order of priority.
<OL><LI>Requests made with exactly the same object of focus as the last <A HREF="dssd0173.htm#If_0001060155030800" TARGET="TEXT">SetFocus</A> method.
<LI>Requests whose object of focus shares a common source filter.
<LI>Requests whose object of focus shares a common filter graph.
<LI>Requests in the same process as the focus.
</OL>
<P>While checking this priority, the resource manager will use <A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> on the focus object for IID_IFilter. If found, the resource manager will use <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> methods to check the filter graph and look for common source filters with the current focus object.

<P>A filter should pass the <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A> interface of the filter in the <I>pFocusObject</I> parameter.
The filter graph manager matches filters to the filter graph and will attempt to trace filters to common source filters when checking objects of focus.

<P>The focus object must be valid for the entire lifetime of the request&#151;until either the
<A HREF="dssd0173.htm#If_0001060155030100" TARGET="TEXT">IResourceManager::CancelRequest</A> method is called, or the
<A HREF="dssd0173.htm#If_0001060155030300" TARGET="TEXT">IResourceManager::NotifyRelease</A> method is called with the
<I>bStillWant</I> parameter set to FALSE.
<H3><HR COLOR=#0000FF><A NAME="If_0001060155030800">IResourceManager::SetFocus</A></H3>
<A HREF="dssd0173.htm" TARGET="TEXT">IResourceManager Interface</A>
<P>Notifies the resource manager that a specified object has been given the
focus of the user.

<P><B>HRESULT</B> <B>SetFocus</B><B>(</B><BR>&nbsp;&nbsp;<B>IUnknown*</B> <I>pFocusObject</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pFocusObject</I>
</DT><DD>[in] Object that has been given the focus of the user.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>In DirectShow, the object given the user's focus is typically
a video renderer whose window has received the focus. The resource manager
gives priority to requests for resources in the following order.

<OL><LI>Requests made with the focus object specified in the <I>pFocusObject</I> parameter.
<LI>Requests whose focus object shares a common source filter.
<LI>Requests whose focus object shares a common filter graph.
<LI>Requests in the same process as the focus.
</OL>
<P>Once a focus has been set, the resource manager must maintain a focus object
until <A HREF="dssd0173.htm#If_0001060155030600" TARGET="TEXT">ReleaseFocus</A> is called.
That is, after calling this method, you must use
<B>ReleaseFocus</B>
before the <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A> interface of the focus object becomes invalid, unless you can
guarantee that <B>SetFocus</B>
is called by a different object in the meantime. No reference count is held on the
focus object.

<P>The resource manager will hold this pointer until replaced or canceled,
and will use it to resolve resource contention. It will use <A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A>
for the <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> interface at least and, if found, will use methods on that interface.
It calls methods on <B>IBaseFilter</B> to decide which audio renderer to use if
there are two (it will choose the one with a source filter common to the focus object),
and also to determine if the two objects are within the same filter graph.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
