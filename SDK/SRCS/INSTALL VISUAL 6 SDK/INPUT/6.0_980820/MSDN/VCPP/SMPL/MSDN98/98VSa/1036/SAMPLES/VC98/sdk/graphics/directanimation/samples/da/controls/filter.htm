<HTML>
<HEAD>
	<TITLE>CSS Filters Demo</TITLE>

<STYLE>
	input.clsbtn {font-size:10;font-family:Verdana;color:yellow;background:black}
</STYLE>

<script language=javascript>
<!--
var filterStrings = new Array();
var count = 0;
var wavable = 1;
var wavphase = 0;
var interval = 225;
var lightinterval = 100;
var lightcount = 0;
var maxStuff = 10;
var light;
var spread = 0;
var position = 0;
var chainable = 1;

function docoda(){
	glbimg.style.display = "none";
	dospin = 1;
	progress.innerText = "Filters can be applied to windowless ActiveX controls like the Structured Graphics control. Here we have several lights pointing at our rotating vector graphic.";
	SG1.style.filter = "light(enabled=1)";
	light = SG1.filters[0];
	light.addambient(0,255,0,40);
	light.addpoint(50,50,40,255,0,0,100); 
	light.addpoint(120,90,30,0,0,255,100); 
	spinit();
}

function uncoda(){
	glbimg.style.display = "";
	glbimg.style.visibility = "visible";
	dospin = 0;
	SG1.style.filter = "";
	progress.innerText = "";
}

function spinit(){	
	if(dospin){
		SG1.rotate(0,0,3);
		window.setTimeout("spinit()", 0300, "JavaScript");
	}
}

function animatwav()
{
	if(wavable){
		wavphase = (wavphase + 10) % 100;
		if(theImg.style.filter == "wave(freq=4, strength=8, phase=0, lightstrength=25, add=1, enabled=1)"){
			theImg.filters[0].phase = wavphase;
		}
		window.setTimeout("animatwav()", 0400, "JavaScript");
	}
}

function chainwav()
{
	if(chainable){
		wavphase = (wavphase + 1) % 10;
		if(theImg.style.filter == "chroma(color=#ff0000,enabled=1) shadow(color=#5555ee,enabled=1) glow(enabled=1)"){
			theImg.filters[2].strength = wavphase;
		}
		window.setTimeout("chainwav()", 0400, "JavaScript");
	}
}

function DoLights()
{
	theImg.style.filter = "light";
	light = theImg.filters[0];
	progress.innerText = "Lights (light): Allows you to apply ambient, point, and cone lighting to objects. Note, adding lights must be done via script (view source for example)";
	LightChange();
}

function LightChange()
{
	if ( lightcount++ < maxStuff )
	{
		spread += 10;
		position += 20;
		light.Clear(); //clear existing lights from collection

		//	this routine is used to add the lights into the light filter collection		//	
		// 	the position and color of the lights in this sample are based off global	//
		//	values.  note the use of setTimeout to drive the animation.  if more 		//
		//	precise control is needed over the timing a sequencer should be used		//
		//	params for lights are:								//
		//											//
		//	addAmbient(rr,gg,bb,intensity)							//
		//	addPoint(x,y,z,rr,gg,bb,intensity)						//
		//	addCone(x,y,z,x-target,y-target,rr,gg,bb,intensity)				//
		//	------------------------------------------------------------------------	//

		light.addCone ( position,position,45,200,200,255,spread,spread,50,spread);
		light.addPoint ( position,position,200,spread,spread,spread,100);
		light.addAmbient ( 255,spread,spread,spread);
		setTimeout ( "LightChange()", lightinterval );
	}
	else
	{
		lightcount = 0;
		spread = 0;
		position = 0;
		document.finished = true;
	}
}

-->
</script>
</HEAD>

<BODY background="../../../media/image/rubbermat.jpg" style="color:ffff00">

<CENTER>
<DIV ID=theImg style="WIDTH:90%; font-size:18pt;font-family:verdana;font-style:bold" >
Filters can affect any HTML element; including text, windowless controls, intrinsic controls, and images. <P>
<IMG id=glbimg hspace=10 vspace=10 width=150 height=150 src="../../../media/image/globe_redmask.gif">

<OBJECT ID=SG1
	STYLE="HEIGHT:150; WIDTH:150"
	CLASSID="CLSID:369303C2-D7AC-11D0-89D5-00A0C90833E6">
    <PARAM NAME="Line0001" VALUE="SetFillStyle(1)">
    <PARAM NAME="Line0002" VALUE="SetFillColor(255,255,255)">
    <PARAM NAME="Line0003" VALUE="Pie(-75,-75,150,150,0,10,0)">
    <PARAM NAME="Line0004" VALUE="SetFillColor(0,90,200)">
    <PARAM NAME="Line0005" VALUE="Pie(-75,-75,150,150,0,10,18)">
    <PARAM NAME="Line0006" VALUE="SetFillColor(255,255,255)">
    <PARAM NAME="Line0007" VALUE="Pie(-75,-75,150,150,0,10,36)">
    <PARAM NAME="Line0008" VALUE="SetFillColor(0,90,200)">
    <PARAM NAME="Line0009" VALUE="Pie(-75,-75,150,150,0,10,54)">
    <PARAM NAME="Line0010" VALUE="SetFillColor(255,255,255)">
    <PARAM NAME="Line0011" VALUE="Pie(-75,-75,150,150,0,10,72)">
    <PARAM NAME="Line0012" VALUE="SetFillColor(0,90,200)">
    <PARAM NAME="Line0013" VALUE="Pie(-75,-75,150,150,0,10,90)">
    <PARAM NAME="Line0014" VALUE="SetFillColor(255,255,255)">
    <PARAM NAME="Line0015" VALUE="Pie(-75,-75,150,150,0,10,108)">
    <PARAM NAME="Line0016" VALUE="SetFillColor(0,90,200)">
    <PARAM NAME="Line0017" VALUE="Pie(-75,-75,150,150,0,10,126)">
    <PARAM NAME="Line0018" VALUE="SetFillColor(255,255,255)">
    <PARAM NAME="Line0019" VALUE="Pie(-75,-75,150,150,0,10,144)">
    <PARAM NAME="Line0020" VALUE="SetFillColor(0,90,200)">
    <PARAM NAME="Line0021" VALUE="Pie(-75,-75,150,150,0,10,162)">
    <PARAM NAME="Line0022" VALUE="SetFillColor(255,255,255)">
    <PARAM NAME="Line0023" VALUE="Pie(-75,-75,150,150,0,10,180)">
    <PARAM NAME="Line0024" VALUE="SetFillColor(0,90,200)">
    <PARAM NAME="Line0025" VALUE="Pie(-75,-75,150,150,0,10,198)">
    <PARAM NAME="Line0026" VALUE="SetFillColor(255,255,255)">
    <PARAM NAME="Line0027" VALUE="Pie(-75,-75,150,150,0,10,216)">
    <PARAM NAME="Line0028" VALUE="SetFillColor(0,90,200)">
    <PARAM NAME="Line0029" VALUE="Pie(-75,-75,150,150,0,10,234)">
    <PARAM NAME="Line0030" VALUE="SetFillColor(255,255,255)">
    <PARAM NAME="Line0031" VALUE="Pie(-75,-75,150,150,0,10,252)">
    <PARAM NAME="Line0032" VALUE="SetFillColor(0,90,200)">
    <PARAM NAME="Line0033" VALUE="Pie(-75,-75,150,150,0,10,270)">
    <PARAM NAME="Line0034" VALUE="SetFillColor(255,255,255)">
    <PARAM NAME="Line0035" VALUE="Pie(-75,-75,150,150,0,10,288)">
    <PARAM NAME="Line0036" VALUE="SetFillColor(0,90,200)">
    <PARAM NAME="Line0037" VALUE="Pie(-75,-75,150,150,0,10,306)">
    <PARAM NAME="Line0038" VALUE="SetFillColor(255,255,255)">
    <PARAM NAME="Line0039" VALUE="Pie(-75,-75,150,150,0,10,324)">
    <PARAM NAME="Line0040" VALUE="SetFillColor(0,90,200)">
    <PARAM NAME="Line0041" VALUE="Pie(-75,-75,150,150,0,10,342)">
    <PARAM NAME="Line0042" VALUE="SetFillColor(255,255,255)">
    <PARAM NAME="Line0043" VALUE="Pie(-75,-75,150,150,0,10,360)">
</OBJECT>
</DIV>
</CENTER>
<p>
<CENTER>
<input CLASS=clsbtn value="FlipH" type=button name=filt onclick="theImg.style.filter = 'fliph(enabled=1)'; progress.innerText = 'Flip Horizontal (fliph): Flips the visible pixels in the horizontal axis.';">
<input CLASS=clsbtn value="FlipV" type=button name=filt onclick="theImg.style.filter = 'flipv(enabled=1)'; progress.innerText = 'Flip Horizontal (flipv): Flips the visible pixels in the vertical axis.';">
<input CLASS=clsbtn value="Gray" type=button name=filt onclick="theImg.style.filter = 'gray(enabled=1)'; progress.innerText = 'Grayscale (gray): Converts the visible pixels 256 shades of gray.';">
<input CLASS=clsbtn value="Invert" type=button name=filt onclick="theImg.style.filter = 'invert(enabled=1)'; progress.innerText = 'Invert (invert): Maps the pixels to their opposite value in the color spectrum.';">
<input CLASS=clsbtn value="XRay" type=button name=filt onclick="theImg.style.filter = 'xray(enabled=1)'; progress.innerText = 'Xray (xray): Grayscales and flattens the color depth.';">

<input CLASS=clsbtn value="Alpha" type=button name=alpha onclick="theImg.style.filter = 'alpha(opacity=50,enabled=1)'; progress.innerText = 'Alpha Channel (alpha): Alters the opacity of the filtered object, allowing it to blend through to the background.';">
<input CLASS=clsbtn value="Blur" type=button name=blur onclick="theImg.style.filter = 'blur(direction=45,strength=15, add=0, enabled=1)'; progress.innerText = 'Motion Blur (blur): Blurs your object with the direction and strength specified.';">
<input CLASS=clsbtn value="Chroma" type=button name=chrom onclick="theImg.style.filter = 'chroma(color=#FF0000 ,enabled=1)'; progress.innerText = 'Chroma Key (chroma): Makes a specified color transparent.';">
<input CLASS=clsbtn value="Drop Shadow" type=button name=drop onclick="theImg.style.filter = 'dropshadow(offx=5, offy=9, color=#008fff,enabled=1)'; progress.innerText = 'Drop Shadow (dropshadow): Creates a shadow of your image at a specified offset and color.';">
<input CLASS=clsbtn value="Glow" type=button name=glow onclick="theImg.style.filter = 'glow(strength=5, color=#ffff00,enabled=1)'; progress.innerText = 'Glow (glow): Creates a glow around the opaque pixels of your object.';">
<input CLASS=clsbtn value="Mask" type=button name=mask onclick="theImg.style.filter = 'mask(color=#FF0000 ,enabled=1)'; progress.innerText = 'Mask (mask): Turns transparent pixels to a specified color and makes opaque pixels transparent.';">
<input CLASS=clsbtn value="Shadow" type=button name=shad onclick="theImg.style.filter = 'shadow(color=#FF0088,direction=315,enabled=1)'; progress.innerText = 'Shadow (shadow): Created an attenuated shadow in the direction and color specified.';">
<input CLASS=clsbtn value="Wave" type=button name=wave onclick="theImg.style.filter = 'wave(freq=2, strength=6, phase=0, lightstrength=0, add=0, enabled=1)'; progress.innerText = 'Wave (wave): Applies a sin wave deformation to your object.';"><P>
<input CLASS=clsbtn value="Animated Sine Wave" type=button name=animwave onclick="theImg.style.filter = 'wave(freq=4, strength=8, phase=0, lightstrength=25, add=1, enabled=1)'; progress.innerText = 'Filter parameters may be altered dynamically for animation.'; wavable = 1; animatwav();">
<input CLASS=clsbtn value="Chained filters" type=button name=chainwave onclick="theImg.style.filter = 'chroma(color=#ff0000,enabled=1) shadow(color=#ff0000,enabled=1) chroma(color=ffff00,enabled=1)'; progress.innerText = 'Filters may be chained for added effects.';">
<input CLASS=clsbtn value="Stage Lights" type=button name=light onclick="DoLights()">
<input CLASS=clsbtn value="Clear Filter" type=button name=clear onclick="theImg.style.filter = ''; progress.innerText = 'pick a filter';">
<input CLASS=clsbtn value="Putting it all together" type=button name=coda onclick="theImg.style.filter = ''; window.setTimeout('docoda()', 0100, 'javascript');">
</CENTER>

<DIV id=progress style="position:absolute;top:90%;font-color:gold;font-size:16pt;font-family:verdana;width:100%;background-color:black;filter:alpha(opacity=40,enabled=1);text-align:center;z-index:-1">Click one of the filter buttons to apply a filter to the objects.</DIV>
<script language="vbscript">
dim notclicked
notclicked = 1

sub window_onload()
	filk = window.setTimeout("maybe", 4000, "vbscript")
end sub
sub document_onclick()
	notclicked = 0
end sub
sub maybe()
	if notclicked then
		progress.innerText = "Come on! Party on the bits. Click a button to apply one of our cool filters."
	end if
end sub
sub animwave_onblur()
	wavable = 0
end sub
sub chainwave_onblur()
	chainable =0
end sub
sub coda_onblur()
	uncoda
end sub
</script>
</BODY>
</HTML>
