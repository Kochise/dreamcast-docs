<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>CEnumMediaTypes Class</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0214.htm','/dssd0000.htm','/dssd0180.htm','/index.htm','/dssd0216.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="Lib_0001060223000000">CEnumMediaTypes Class</A></H2>
<BR CLEAR=ALL>
<P><IMG SRC="art/filter04.gif" WIDTH="195" HEIGHT="52" ALT="CEnumMediaTypes class hierarchy" >

<P>This class provides the mechanism for enumerating the pin's preferred media types.
Its constructor must be passed to an object from a class derived from <A HREF="dssd0200.htm" TARGET="TEXT">CBasePin</A>.
It uses the virtual member function <A HREF="dssd0200.htm#Lib_0001060214061500" TARGET="TEXT">GetMediaType</A> to
retrieve each of the media types in turn. It also uses the pin's
<A HREF="dssd0200.htm#Lib_0001060214061600" TARGET="TEXT">CBasePin::GetMediaTypeVersion</A> member function to determine if the
number or type of media types has changed.

<P>The base pin class does not support dynamic media type changes. <A HREF="dssd0194.htm#Lib_000106020e080800" TARGET="TEXT">CBaseFilter::GetPinVersion</A>
always returns the same value, for example.

<P>The media type enumerator must fill in a list of pointers to media type structures. 
The memory for those media type structures must be released by the callers when they have 
finished with it. However, the memory must not be allocated from any language-specific heap; 
otherwise, problems might occur between a filter written in C and another written in C++. 
For this reason, the base classes provide generic functions (not member functions of a class) 
to create and delete media types: <A HREF="dssd0267.htm#fmutil_000106030b000300" TARGET="TEXT">CreateMediaType</A> and <A HREF="dssd0267.htm#fmutil_000106030b000400" TARGET="TEXT">DeleteMediaType</A>. These manage memory allocation from the task allocator.

<P>All member functions in this class that return <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> and accept a pointer as a 
parameter return E_POINTER when passed a null pointer. 

<A NAME="Lib_0001060223010000"></A><P><B>Member Functions</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0215.htm#Lib_0001060223030200" TARGET="TEXT">CEnumMediaTypes</A>
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Constructs a <A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes</A> object.
</FONT></TD></TR></TABLE>
<A NAME="Lib_0001060223020000"></A><P><B>Implemented IUnknown Methods</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0215.htm#Lib_0001060223030500" TARGET="TEXT">QueryInterface</A> 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0215.htm#Lib_0001060223030100" TARGET="TEXT">AddRef</A> 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0215.htm#Lib_0001060223030600" TARGET="TEXT">Release</A> 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<A NAME="Lib_0001060223030000"></A><P><B>Implemented IEnumMediaTypes Methods</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0215.htm#Lib_0001060223030300" TARGET="TEXT">Clone</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates a duplicate <A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes</A> object with the same state.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0215.htm#Lib_0001060223030400" TARGET="TEXT">Next</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the next media type after the current position.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0215.htm#Lib_0001060223030700" TARGET="TEXT">Reset</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the current position back to the beginning.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0215.htm#Lib_0001060223030800" TARGET="TEXT">Skip</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Skips over one or more entries in the enumerator.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="Lib_0001060223030100">CEnumMediaTypes::AddRef</A></H3>
<A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes Class</A>
<P>Increments the reference count for the calling interface on an object.
It should be called for every new copy of a pointer to an interface on a given object.

<P><B>ULONG</B> <B>AddRef</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an integer from 1 to <I>n</I>, the value of the new reference count.
This information is meant to be used for diagnostic/testing purposes only,
because, in certain situations, the value might be unstable.


<H5>Remarks</H5>
<P>This member function implements the <A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">IUnknown::AddRef</A> method.
<H3><HR COLOR=#0000FF><A NAME="Lib_0001060223030200">CEnumMediaTypes::CEnumMediaTypes</A></H3>
<A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes Class</A>
<P>Constructs a <A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes</A> object.

<P><B>CEnumMediaTypes</B><B>(</B><BR>&nbsp;&nbsp;<B>CBasePin</B> <I>*pPin</I><B>,</B><BR>&nbsp;&nbsp;<B>CEnumMediaTypes</B> <I>*pEnumMediaTypes</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pPin</I>
</DT><DD>Pointer to the pin on which the enumeration is to be performed.
</DD><DT><I>pEnumMediaTypes</I>
</DT><DD>Pointer to the instantiated <A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes</A> object.
</DD></DL>
<H5>Return Values</H5>
<P>No return value.
<H5>Remarks</H5>
<P>This is a standard class constructor.


<H3><HR COLOR=#0000FF><A NAME="Lib_0001060223030300">CEnumMediaTypes::Clone</A></H3>
<A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes Class</A>
<P>Retrieves another enumerator containing the same enumeration state as the current one.

<P><B>HRESULT</B> <B>Clone</B><B>(</B><BR>&nbsp;&nbsp;<B>IEnumMediaTypes</B> <B>**</B> <I>ppEnum</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppEnum</I>
</DT><DD>New copy of the enumerator.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This member function implements the <A HREF="dssd0132.htm#If_000106012c030100" TARGET="TEXT">IEnumMediaTypes::Clone</A> method.
<H3><HR COLOR=#0000FF><A NAME="Lib_0001060223030400">CEnumMediaTypes::Next</A></H3>
<A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes Class</A>
<P>Retrieves the specified number of items in the enumeration sequence.

<P><B>HRESULT</B> <B>Next</B><B>(</B><BR>&nbsp;&nbsp;<B>ULONG</B> <I>cMediaTypes</I><B>,</B><BR>&nbsp;&nbsp;<B>AM_MEDIA_TYPE**</B> <I>ppMediaTypes</I><B>,</B><BR>&nbsp;&nbsp;<B>ULONG</B> <B>*</B> <I>pcFetched</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>cMediaTypes</I>
 </DT><DD>Number of media types to place.
</DD><DT><I>ppMediaTypes</I>
 </DT><DD>Array in which to place the next media type or types.
</DD><DT><I>pcFetched</I>
 </DT><DD>Actual count passed.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This member function implements the <A HREF="dssd0132.htm#If_000106012c030200" TARGET="TEXT">IEnumMediaTypes::Next</A> method.
To call this method, pass a pointer's address to a
media type. The base class implementation relies on the existence of an
overridden <A HREF="dssd0200.htm#Lib_0001060214061500" TARGET="TEXT">CBasePin::GetMediaType</A> member function in the derived
class that will provide the next media type.

<P>Free each media type acquired by calling <A HREF="dssd0267.htm#fmutil_000106030b000400" TARGET="TEXT">DeleteMediaType</A>, which will free the
format block and the media type itself.

<H3><HR COLOR=#0000FF><A NAME="Lib_0001060223030500">CEnumMediaTypes::QueryInterface</A></H3>
<A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes Class</A>
<P>Retrieves a pointer to a specified interface on a component to which a
client currently holds an interface pointer. 

<P><B>HRESULT</B> <B>QueryInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>iid</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <B>**</B> <I>ppvObject</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>iid</I>
 </DT><DD>Specifies the IID of the interface being requested.
</DD><DT><I>ppvObject</I>
 </DT><DD>Receives a pointer to an interface pointer to the object on return.
If the interface specified in <I>iid</I> is not supported
by the object, <I>ppvObject</I> is set to NULL.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if the interface is supported, S_FALSE if not.


<H5>Remarks</H5>
<P>This member function implements the <A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">IUnknown::QueryInterface</A> method
and passes out references to the <A HREF="dssd0132.htm" TARGET="TEXT">IEnumMediaTypes</A> interface.
Override this class to return other interfaces on the object in the derived class.
<H3><HR COLOR=#0000FF><A NAME="Lib_0001060223030600">CEnumMediaTypes::Release</A></H3>
<A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes Class</A>
<P>Decrements the reference count for the calling interface on an object.
If the reference count on the object falls to zero, the object is freed from memory.

<P><B>ULONG</B> <B>Release</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the resulting value of the reference count, which is used for
diagnostic/testing purposes only. If you need to know that resources have been freed,
use an interface with higher-level semantics.


<H5>Remarks</H5>
<P>This member function implements the <A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">IUnknown::Release</A> method.
<H3><HR COLOR=#0000FF><A NAME="Lib_0001060223030700">CEnumMediaTypes::Reset</A></H3>
<A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes Class</A>
<P>Resets the enumerator to the beginning so that the next call to the
<A HREF="dssd0132.htm#If_000106012c030200" TARGET="TEXT">IEnumMediaTypes::Next</A> method will return, at a minimum,
the first media type in the enumeration.

<P><B>HRESULT</B> <B>Reset</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns S_OK if successful; otherwise, returns S_FALSE.

<H5>Remarks</H5>
<P>This member function implements the <A HREF="dssd0132.htm#If_000106012c030300" TARGET="TEXT">IEnumMediaTypes::Reset</A> method.
<H3><HR COLOR=#0000FF><A NAME="Lib_0001060223030800">CEnumMediaTypes::Skip</A></H3>
<A HREF="dssd0215.htm" TARGET="TEXT">CEnumMediaTypes Class</A>
<P>Skips a specified number of elements in the enumeration sequence.

<P><B>HRESULT</B> <B>Skip</B><B>(</B><BR>&nbsp;&nbsp;<B>ULONG</B> <I>cMediaTypes</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>cMediaTypes</I>
</DT><DD>Number of media type elements to skip.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This member function implements the <A HREF="dssd0132.htm#If_000106012c030400" TARGET="TEXT">IEnumMediaTypes::Skip</A> method.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
